function gObjectClone(e){if(e){var t=JSON.stringify(e),n=JSON.parse(t);return n}return null}function mobileReg(e){var t=/^1[3|4|5|7|8|][0-9]{9}$/;return t.test(e)}function gObjectCopy(e,t){for(var n in t)"function"!=typeof t[n]&&(e[n]=t[n])}function gArrayCopy(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}function ajaxGetBackend(e,t,n){$.ajax({url:"/app"+e,type:"GET",data:t,dataType:"json",success:function(e){n(e)},error:function(){}})}function ajaxPostBackend(e,t,n){$.ajax({url:"/app"+e,type:"POST",data:t,dataType:"json",success:function(e){n(e)},error:function(){}})}function ajaxGet(e,t,n){var r=null;try{r=$.loading({content:""})}catch(a){}$.ajax({url:"/app"+e,type:"GET",data:t,dataType:"json",success:function(e){try{r.loading("hide")}catch(t){}n(e)},error:function(){try{r.loading("hide")}catch(e){}}})}function ajaxPost(e,t,n){var r=null;try{r=$.loading({content:""})}catch(a){}$.ajax({url:"/app"+e,type:"POST",data:t,dataType:"json",success:function(e){try{r.loading("hide")}catch(t){}n(e)},error:function(){try{r.loading("hide")}catch(e){}}})}function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}function chineseToUtf8(e){return e=e.replace(/[^u0000-u00FF]/g,function(e){return escape(e).replace(/(%u)(w{4})/gi,"&#x$2;")})}function chineseFromUtf8(e){return e=unescape(e.replace(/&#x/g,"%u").replace(/;/g,""))}function showInfoTip(e){$.tips({content:e,stayTime:2e3,type:"info"})}function showSuccessTip(e){$.tips({content:e,stayTime:2e3,type:"success"})}function showWarnTip(e){$.tips({content:e,stayTime:2e3,type:"warn"})}function showDialog(e,t,n,r){var a=$.dialog({title:e,content:t,button:n});a.on("dialog:action",function(e){e.stopPropagation(),r(e.index)})}function showSelectDialog(e,t,n){showDialog(e,t,["确认","取消"],function(e){0==e&&n&&n(e)})}function showConfirmDialog(e,t,n){showDialog(e,t,["确认"],function(e){0==e&&n&&n(e)})}function convertUrl(e){for(var t=e.split("?"),n=t[0],r=!0,a=t[1],i=a.split("&"),o=0;o<i.length;o++){var s=i[o].split("="),l=s[0],c=s[1];"code"!=l&&"wechat_card_js"!=l&&"state"!=l&&(r?(r=!1,n=n+"?"+l+"="+c):n=n+"&"+l+"="+c)}return n}function createModel(e,t){var n=avalon.vmodels[e];return n?n.onFocus&&n.onFocus():(n=t(e),n.init()),n.initValidation&&n.initValidation(),avalon.scan(document.body,n),n.afterScreenBind&&n.afterScreenBind(),n}function dynamicImageHandler(e){var t=$(window).width();$("#"+e+" img").each(function(){if(this.complete){var e=$(this).width();(e>t||0==e)&&$(this).css("width","100%")}else this.onload=function(){var e=$(this).width();e>t&&$(this).css("width","100%")}})}function AppManager(){this.client=null,this.domain=null,this.openid=null,this.weixinConfig=null,this.attachedUrl=null,this.login=function(e,t){var n=this,r=window.location.href,a=getQueryString("code"),i=getQueryString("domain");a&&(a.length>0?ajaxGet("/weixin/login",{code:a,url:r,type:t,domainId:i},function(t){if(t.openid)n.openid=t.openid;else{r=convertUrl(r);var a="http://"+window.location.host+"/app/weixin/access?url="+r;window.location.href=a}if(0==t.code){if(n.client=t.client,n.domain=t.domain,n.weixinConfig=t.weixinConfig,n.weixinConfig)try{n.initWeixinConfig(n.weixinConfig)}catch(i){}e(n.client,n.domain)}else 99==t.code?e("new_client",null):e(null,null)}):e(null,null,null))},this.initWeixinConfig=function(e){wx.config(e),wx.ready(function(){wx.showOptionMenu(),wx.hideMenuItems({menuList:["menuItem:refresh","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:openWithQQBrowser","menuItem:openWithSafari"]}),shareManager.initShare()}),wx.error(function(){alert("微信初始化出错，可能导致系统某些功能无法正常运行")})},this.register=function(e){var t=this,n=getQueryString("code"),r=getQueryString("domain");n&&(n.length>0?ajaxGet("/weixin/register",{code:n,domainId:r},function(n){n.openid&&(t.openid=n.openid),0==n.code?(t.client=n.client,t.attachedUrl=n.attachedUrl,e(t.client)):e(null)}):e(null))},this.init=function(e){var t=this,n=getQueryString("code"),r=getQueryString("state");n&&n.length>0?$.ajax("base"==r?{type:"GET",url:"/weixin/getUserOpenId",data:{code:n},dataType:"json",success:function(n){0==n.code&&(t.currentUserOpenId=n.data.openid,e(t.currentUserOpenId))}}:{type:"GET",url:"/weixin/getUserInfo",data:{code:n},dataType:"json",success:function(n){0==n.code&&(t.currentUserOpenId=n.data.openid,t.currentUserInformation=n.data,e(t.currentUserOpenId))}}):e("")},this.convertUrlWithWeixinAuth=function(e){return this.convertUrlWithWeixinAuthCommand(e,!1)},this.convertUrlWithWeixinAuthUserInfo=function(e){return this.convertUrlWithWeixinAuthCommand(e,!0)},this.convertUrlWithWeixinAuthCommand=function(e,t){var n=window.location.host;return e.indexOf("http")<0&&(e="http://"+n+"/app"+e),e=t?"http://"+n+"/app/weixin/access?type=userinfo&url="+encodeURIComponent(e):"http://"+n+"/app/weixin/access?url="+encodeURIComponent(e)},this.convertImageUrl=function(e){return e.indexOf("http")>=0||e.indexOf("HTTP")>=0?e:"http://"+window.location.host+e}}function isAndroidDevice(){var e=navigator.userAgent,t=(navigator.appVersion,e.indexOf("Android")>-1||e.indexOf("Linux")>-1);return t}function isIOSDevice(){var e=navigator.userAgent,t=(navigator.appVersion,!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/));return t}!function(e){function t(){}function n(e){yt.console&&avalon.config.debug&&console.log(Lt?e:e+"")}function r(e,t){"string"==typeof e&&(e=e.match(Tt)||[]);for(var n={},r=void 0!==t?t:1,a=0,i=e.length;i>a;a++)n[e[a]]=r;return n}function i(){return"avalon"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function o(e){return St.test(kt.call(e))}function s(e,t){return e=Math.floor(e)||0,0>e?Math.max(t+e,0):Math.min(e,t)}function l(e){if(e&&"object"==typeof e&&!avalon.isWindow(e)){var t=e.length;if(+t===t&&!(t%1)&&t>=0)try{return{}.propertyIsEnumerable.call(e,"length")===!1?Array.isArray(e)||/^\s?function/.test(e.item||e.callee):!0}catch(n){return!0}}return!1}function c(e,t){if(Array.isArray(e)){var r=e.concat();e.length=0;var a=nt(e);return a.push.apply(a,r),a}if("number"==typeof e.nodeType)return e;if(e.$id&&e.$model&&e.$events)return e;var o={};t=t||{};for(var s,l={},c={},u=[],d=avalon.mix({},arguments[2]||{}),h=e.$skipArray,p=0;s=jt[p++];)delete e[s],c[s]=!0;if(Array.isArray(h))for(var s,p=0;s=h[p++];)"string"!=typeof s&&n("warning:$skipArray["+s+"] must be a string"),c[s]=!0;for(var p in e)f(p,e[p],t,c,l,u,d);o=Xt(o,Wt(l),c);for(var s in c)o[s]=c[s];d.vmodel=o,o.$model=t,o.$events={},o.$id=i(),o.$accessors=l,o[mt]=[];for(var p in Nn){var v=Nn[p];Lt||(v=v.bind(o)),o[p]=v}o.hasOwnProperty=function(e){return e in o.$model};for(var v,p=0;v=u[p++];)It[gt]=v,v(),D(v),delete It[gt];return o}function u(e,t,n,r){e.$events&&Nn.$fire.call(e,t,n,r)}function f(e,t,n,r,a,i,o){if(n[e]=t,r[e]||t&&t.nodeType||"$"===e.charAt(0)&&!o[e])return r[e]=t;var s=avalon.type(t);if("function"===s)return r[e]=t;var l,f;if("object"===s&&"function"==typeof t.get&&Object.keys(t).length<=2){var p=t.set,v=t.get;l=function(t){var r=o.vmodel,a=n[e],i=a;if(!arguments.length)return avalon.openComputedCollect&&D(l),t=n[e]=v.call(r),Ft(a,t)||(f=void 0,u(r,e,t,i)),t;if(!xt){if("function"==typeof p){var s=r.$events[e];r.$events[e]=[],p.call(r,t),r.$events[e]=s}Ft(f,t)||(f=t,t=n[e]=v.call(r),Vt&&d(r.$id,e,t),L(l),u(r,e,t,i))}},i.push(l)}else Ct.test(s)?(l=function(t){var r=l.$vmodel,a=r.$model;if(!arguments.length)return D(r),r;if(!xt&&!Ft(a,t)){t=l.$vmodel=h(r,t,s);var i=zt[t.$id];i&&i();var c=o.vmodel;n[e]=t.$model,L(r),u(c,e,n[e],a)}},l.$vmodel=t.$model?t:c(t,t),n[e]=l.$vmodel.$model):(l=function(t){var r=n[e];if(!arguments.length)return D(l),r;if(!Ft(r,t)){n[e]=t;var a=o.vmodel;Vt&&d(a.$id,e,t),L(l),u(a,e,t,r)}},n[e]=t);l[mt]=[],a[e]=l}function d(e,t,n){var r=Ut[e];r&&r[t]&&(r[t].$val=n)}function h(e,t,n){if("array"===n){if(!Array.isArray(t))return e;var r=t.concat();return e.clear(),e.push.apply(e,r),e}var a=e[mt]||[];Ut[e.$id]&&(Vt--,delete Ut[e.$id]);var i=c(t);return zt[i.$id]=function(e){for(;e=a.shift();)!function(e){e.type&&avalon.nextTick(function(){e.rollback&&e.rollback(),kr[e.type](e,e.vmodels)})}(e);delete zt[i.$id]},i}function p(e,t,n){var r=e[t];if("function"==typeof r){if(3!==arguments.length)return r();r(n)}}function v(e,t,n){var r="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",r)}function g(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1}function m(){return(new XMLSerializer).serializeToString(this)}function y(e,t){if(e&&e.childNodes)for(var n,r=e.childNodes,a=0;n=r[a++];)if(n.tagName){var i=document.createElementNS(en,n.tagName.toLowerCase());$t.forEach.call(n.attributes,function(e){i.setAttribute(e.name,e.value)}),y(n,i),t.appendChild(i)}}function w(e){for(var t in e)if(At.call(e,t)){var n=e[t];"function"==typeof w.plugins[t]?w.plugins[t](n):"object"==typeof w[t]?avalon.mix(w[t],n):w[t]=n}return this}function b(e){return(e+"").replace(ln,"\\$&")}function x(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function T(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function _(e){if(!("classList"in e)){e.classList={node:e};for(var t in un)e.classList[t.slice(1)]=un[t]}return e.classList}function C(e){try{e="true"===e?!0:"false"===e?!1:"null"===e?null:+e+""===e?+e:fn.test(e)?avalon.parseJSON(e):e}catch(t){}return e}function M(e){return e.window&&e.document?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}function S(e,t){if(e.offsetWidth<=0){if(Mn.test(gn["@:get"](e,"display"))){var n={node:e};for(var r in Cn)n[r]=e.style[r],e.style[r]=Cn[r];t.push(n)}var a=e.parentNode;a&&1===a.nodeType&&S(a,t)}}function E(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}function A(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}function k(e){"url(#default#VML)"!==e.currentStyle.behavior&&(e.style.behavior="url(#default#VML)",e.style.display="inline-block",e.style.zoom=1)}function $(t){It[gt]=t,avalon.openComputedCollect=!0;var r=t.evaluator;if(r)try{var a=Rn.test(t.type)?t:r.apply(0,t.args);t.handler(a,t.element,t)}catch(i){n("warning:exception throwed in [registerSubscriber] "+i),delete t.evaluator;var o=t.element;if(3===o.nodeType){var s=o.parentNode;w.commentInterpolate?s.replaceChild(e.createComment(t.value),o):o.data=nn+t.value+rn}}else t();avalon.openComputedCollect=!1,delete It[gt]}function D(e){if(It[gt]){var t=e[mt];if(t){var n=It[gt];avalon.Array.ensure(t,n),n.element&&jn.push({data:n,list:t})}}}function I(){for(var e,t=jn.length;e=jn[--t];){var r=e.data,a=r.element,i=null===a?1:1===a.nodeType?"number"==typeof a.sourceIndex?0===a.sourceIndex:!Ot.contains(a):!avalon.contains(Ot,a);if(i){if(jn.splice(t,1),avalon.Array.remove(e.list,r),n("debug: remove "+r.type),"if"===r.type&&r.template)try{Pt.removeChild(r.template)}catch(o){}e.data=e.list=r.evaluator=r.element=r.vmodels=null}}}function L(e){var n=new Date;clearTimeout(Pn),n-Fn>300?(I(),Fn=n):Pn=setTimeout(I,300);var r=e[mt];if(r&&r.length)for(var a,i=Dt.call(arguments,1),o=r.length;a=r[--o];){var s=a.element;if("function"==typeof a)a.apply(0,i);else if(a.$repeat)a.handler.apply(a,i);else if(a.element&&"on"!==a.type){var l=a.evaluator||t;a.handler(l.apply(0,a.args||[]),s,a)}}}function O(e,t){var n=0/0,r=setInterval(function(){var a=e.innerHTML;a===n?(clearInterval(r),t()):n=a},Un)}function P(e,t,r){var a=e.getAttribute(vt+"skip");if(!e.getAttributeNode)return n("warning "+e.tagName+" no getAttributeNode method");var i=e.getAttributeNode(vt+"important"),o=e.getAttributeNode(vt+"controller");if("string"!=typeof a){if(r=i||o){var s=Rt[r.value];if(!s)return;t=r===i?[s]:[s].concat(t);var l=r.name;e.removeAttribute(l),e.setAttribute("avalonctrl",r.value),s.$events.expr=e.tagName+'[avalonctrl="'+r.value+'"]',avalon(e).removeClass(l)}F(e,t)}}function N(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;B(n,n.nodeType,t),n=r}}function H(e,t){for(var n,r=0;n=e[r++];)B(n,n.nodeType,t)}function B(e,t,n){1===t?P(e,n):3===t&&an.test(e.data)?R(e,n):w.commentInterpolate&&8===t&&!an.test(e.nodeValue)&&R(e,n)}function R(t,n){var r=[];if(8===t.nodeType){var a=[],i=U(t.nodeValue,a),o={expr:!0,value:i};a.length&&(o.filters=a);var s=[o]}else s=V(t.data);if(s.length){for(var o,l=0;o=s[l++];){var c=e.createTextNode(o.value);if(o.expr){var u=o.filters,f={type:"text",element:c,value:o.value,filters:u};u&&-1!==u.indexOf("html")&&(avalon.Array.remove(u,"html"),f.type="html",f.group=1,u.length||delete r.filters),r.push(f)}Nt.appendChild(c)}t.parentNode.replaceChild(Nt,t),r.length&&W(r,n)}}function j(e,t){return e.priority-t.priority}function F(e,t){for(var r,a,i=Kn?Kn(e):avalon.slice(e.attributes),o=[],s={},l=0;a=i[l++];)if(a.specified&&(r=a.name.match(Vn))){var c=r[1],u=r[2]||"",f=a.value,d=a.name;if(s[d]=f,Gn[c]?(u=c,c="on"):"enabled"===c&&(c="disabled",f="!("+f+")"),("checked"===c||"selected"===c||"disabled"===c||"readonly"===c)&&(u=c,c="attr",e.removeAttribute(d),d="ms-attr-"+u,e.setAttribute(d,f),r=[d],s[d]=f),"function"==typeof kr[c]){var h={type:c,param:u,element:e,name:r[0],value:f,priority:c in zn?zn[c]:10*c.charCodeAt(0)+(Number(u)||0)};"if"===c&&u.indexOf("loop")>-1&&(h.priority+=100),t.length&&(o.push(h),"widget"===c&&(e.msData=e.msData||s))}}o.sort(j),s["ms-checked"]&&s["ms-duplex"]&&n("warning!一个元素上不能同时定义ms-checked与ms-duplex");var p=o[0]||{};switch(p.type){case"if":case"repeat":case"widget":W([p],t);break;default:W(o,t),!Wn[e.tagName]&&sn.test(e.innerHTML.replace(nr,"<").replace(rr,">"))&&N(e,t)}}function W(e,t){for(var n,r=0;n=e[r++];)n.vmodels=t,kr[n.type](n,t),n.evaluator&&n.element&&1===n.element.nodeType&&n.element.removeAttribute(n.name);e.length=0}function U(e,t){return e.indexOf("|")>0&&(e=e.replace(er,"U2hvcnRDaXJjdWl0"),e=e.replace(Zn,function(e,n,r){return t.push(n+(r||"")),""}),e=e.replace(tr,"||")),e}function V(e){for(var t,n,r=[],a=0;;){if(n=e.indexOf(nn,a),-1===n)break;if(t=e.slice(a,n),t&&r.push({value:t,expr:!1}),a=n+nn.length,n=e.indexOf(rn,a),-1===n)break;if(t=e.slice(a,n)){var i=[];t=U(t,i),r.push({value:t,expr:!0,filters:i.length?i:void 0})}a=n+rn.length}return t=e.slice(a),t&&r.push({value:t,expr:!1}),r}function z(e,t,n,r){for(var a,i=[],o=" = "+n+".",s=e.length;a=e[--s];)t.hasOwnProperty&&t.hasOwnProperty(a)&&(i.push(a+o+a),"duplex"===r&&(e.get=n+"."+a),e.splice(s,1));return i}function G(e){for(var t=[],n={},r=0;r<e.length;r++){var a=e[r],i=a&&"string"==typeof a.$id?a.$id:a;n[i]||(n[i]=t.push(a))}return t}function X(e){function t(r,a){return n.push(r)>e&&delete t[n.shift()],t[r]=a}var n=[];return t}function Q(e,r,a){var i=a.type,o=a.filters?a.filters.join(""):"",s=r.map(function(e){return e.$id.replace(pr,"$1")})+e+i+o,l=fr(e).concat(),c=[],u=[],f=[],d="";r=G(r);for(var h=0,p=r.length;p>h;h++)if(l.length){var v="vm"+gt+"_"+h;u.push(v),f.push(r[h]),c.push.apply(c,z(l,r[h],v,i))}if(c.length||"duplex"!==i){o&&f.push(avalon.filters),a.args=f;var g=dr[s];if(g)return void(a.evaluator=g);var d=c.join(", ");if(d&&(d="var "+d),o){e="\nvar ret"+gt+" = "+e;var m,y=[];y.push(e,"\r\n");for(var w,h=0;w=a.filters[h++];){var b=w.indexOf("(");-1!==b?(m=w.slice(b+1,w.lastIndexOf(")")).trim(),m=","+m,w=w.slice(0,b).trim()):m="",y.push(" if(filters",gt,".",w,"){\n	try{\nret",gt," = filters",gt,".",w,"(ret",gt,m,")\n	}catch(e){} \n}\n")}e=y.join(""),e+="\nreturn ret"+gt,u.push("filters"+gt)}else{if("duplex"===i){var x="'use strict';\nreturn function(vvv){\n	"+d+";\n	if(!arguments.length){\n		return "+e+"\n	}\n	"+(hr.test(e)?e:l.get)+"= vvv;\n} ";try{g=Function.apply(t,u.concat(x)),a.evaluator=dr(s,g)}catch(T){n("debug: parse error,"+T.message)}return}if("on"===i){-1===e.indexOf("(")?e+=".call(this, $event)":e=e.replace("(",".call(this,"),u.push("$event"),e="\nreturn "+e+";";var _=e.lastIndexOf("\nreturn"),C=e.slice(0,_),M=e.slice(_);e=C+"\n"+M}else e="\nreturn "+e+";"}try{g=Function.apply(t,u.concat("'use strict';\n"+d+e)),a.evaluator=dr(s,g)}catch(T){n("debug: parse error,"+T.message)}finally{l=y=u=null}}}function Y(e,t,n,r){Array.isArray(r)&&(e=r.map(function(e){return e.expr?"("+e.value+")":gr(e.value)}).join(" + ")),Q(e,t,n),n.evaluator&&(n.handler=Er[n.handlerName||n.type],$(n))}function q(t,n){var r="_"+t;if(!q[r]){var a=e.createElement(t);Ot.appendChild(a),n=Lt?getComputedStyle(a,null).display:a.currentStyle.display,Ot.removeChild(a),q[r]=n}return q[r]}function J(t,n,r){var a=e.createEvent("Events");a.initEvent(n,!0,!0),r&&(a.detail=r),t.dispatchEvent(a)}function K(){this.disabled||this.oldValue===this.value||(Lt?J(this,"input"):this.fireEvent("onchange"))}function Z(){for(var e=Ir.length-1;e>=0;e--){var t=Ir[e];t()===!1&&Ir.splice(e,1)}Ir.length||clearInterval(Dr)}function et(e){Pr.call(this,e),e!==this.oldValue&&J(this,"input")}function tt(t){var n={};for(var r in t)n[r]=t[r];var a=n.target=t.srcElement;if(0===t.type.indexOf("key"))n.which=null!=t.charCode?t.charCode:t.keyCode;else if(/mouse|click/.test(t.type)){var i=a.ownerDocument||e,o="BackCompat"===i.compatMode?i.body:i.documentElement;n.pageX=t.clientX+(o.scrollLeft>>0)-(o.clientLeft>>0),n.pageY=t.clientY+(o.scrollTop>>0)-(o.clientTop>>0),n.wheelDeltaY=n.wheelDelta,n.wheelDeltaX=0}return n.timeStamp=new Date-0,n.originalEvent=t,n.preventDefault=function(){t.returnValue=!1},n.stopPropagation=function(){t.cancelBubble=!0},n}function nt(e){var t=[];t.$id=i(),t[mt]=[],t.$model=e,t.$events={},t._=c({length:e.length}),t._.$watch("length",function(e,n){t.$fire("length",e,n)});for(var n in Nn)t[n]=Nn[n];return avalon.mix(t,jr),t}function rt(e){return Ct.test(avalon.type(e))&&(e=e.$id?e:c(e,e)),e}function at(e,t,n,r){var a=avalon.parseHTML(e.template),i=avalon.slice(a.childNodes);t.appendChild(a),n.$outer=e.$outer;var o={nodes:i,vmodels:[n].concat(e.vmodels)};r.push(o)}function it(e,t){var n=e.element;if("repeat"==e.type)for(var r=n.nextSibling,a=0,i=t;i>a&&r;a++)r=r.nextSibling;else{var o=avalon.slice(n.parentNode.childNodes,1),s=e.group||o.length/e.proxies.length;r=o[s*t]}return r||null}function ot(e,t,n){for(var r=t*(n||1),a=[e],i=1,o=Nt;r>i;)e=e.nextSibling,e&&(a[i++]=e);for(var i=0;e=a[i++];)o.appendChild(e);return o}function st(e){if(!isFinite(e.group)){var t=avalon.slice(e.element.parentNode.childNodes,1),n="proxySize"in e?e.proxySize:e.proxies.length;e.group=t.length/n}}function lt(e,t,n){var r=c({$key:e,$outer:n,$val:t},0,{$val:1,$key:1});return r.$id=("$proxy$with"+Math.random()).replace(/0\./,""),r}function ct(e,t,n,r){var a,i=n.param||"el",o={$remove:function(){return n.$repeat.removeAt(a.$index)},$itemName:i,$index:e,$outer:n.$outer,$first:0===e,$last:e===r};o[i]=t;for(var s=0,l=Wr.length;l>s;s++){var a=Wr[s];if(a.hasOwnProperty(i)){for(var u in o)a[u]=o[u];return Wr.splice(s,1),a}}return Ct.test(avalon.type(t))&&(o.$skipArray=[i]),a=c(o,0,Fr),a.$watch(i,function(e){n.$repeat.set(a.$index,e)}),a.$id=("$proxy$"+n.type+Math.random()).replace(/0\./,""),a}function ut(e){for(var t,n=0;t=e[n++];)dt(t);e.length=0}function ft(e,t){e&&Array.isArray(t=e[mt])&&(t.forEach(function(e){e.evaluator&&(e.evaluator=e.element=null)}),t.length=0)}function dt(e){var t=e.$accessors,n=e.$itemName;ft(t.$index),ft(t.$last),ft(t.$first),ft(t[n]),ft(e[n]),e.$events={},Wr.unshift(e)>w.maxRepeatSize&&Wr.pop()}function ht(){e.body&&(qr?(Jr["ready!"].state=2,qr.checkDeps()):Kr.forEach(function(e){e(avalon)}),ht=t)}function pt(){try{Ot.doScroll("left"),ht()}catch(e){setTimeout(pt)}}var vt="ms-",gt=new Date-0,mt="$"+gt,yt=this||(0,eval)("this"),wt=yt.require,bt=yt.define,xt=!1,Tt=/[^, ]+/g,_t=/\[native code\]/,Ct=/^(?:object|array)$/,Mt=/^\[object SVG\w*Element\]$/,St=/^\[object (?:Window|DOMWindow|global)\]$/,Et=Object.prototype,At=Et.hasOwnProperty,kt=Et.toString,$t=Array.prototype,Dt=$t.slice,It={},Lt=yt.dispatchEvent,Ot=e.documentElement,Pt=e.getElementsByTagName("head")[0],Nt=e.createDocumentFragment(),Ht=e.createElement("div"),Bt={};"Boolean Number String Function Array Date RegExp Object Error".replace(Tt,function(e){Bt["[object "+e+"]"]=e.toLowerCase()}),avalon=function(e){return new avalon.init(e)},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Bt[kt.call(e)]||"object":typeof e},avalon.isFunction="object"==typeof alert?function(e){try{return/^\s*\bfunction\b/.test(e+"")}catch(t){return!1}}:function(e){return"[object Function]"==kt.call(e)},avalon.isWindow=function(e){return e?e==e.document&&e.document!=e:!1},o(yt)&&(avalon.isWindow=o),avalon.isPlainObject=function(e,t){if(!e||"object"!==avalon.type(e)||e.nodeType||avalon.isWindow(e))return!1;try{if(e.constructor&&!At.call(e,"constructor")&&!At.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}for(t in e);return void 0===t||At.call(e,t)},_t.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return!!e&&"object"==typeof e&&Object.getPrototypeOf(e)===Et}),avalon.mix=avalon.fn.mix=function(){var e,t,n,r,a,i,o=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[1]||{},s++),"object"!=typeof o&&"function"!==avalon.type(o)&&(o={}),s===l&&(o=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e)n=o[t],r=e[t],o!==r&&(c&&r&&(avalon.isPlainObject(r)||(a=Array.isArray(r)))?(a?(a=!1,i=n&&Array.isArray(n)?n:[]):i=n&&avalon.isPlainObject(n)?n:{},o[t]=avalon.mix(c,i,r)):void 0!==r&&(o[t]=r));return o},avalon.mix({rword:Tt,subscribers:mt,version:1.36,ui:{},log:n,slice:Lt?function(e,t,n){return Dt.call(e,t,n)}:function(e,t,n){var r=[],a=e.length;if(void 0===n&&(n=a),"number"==typeof n&&isFinite(n)){t=s(t,a),n=s(n,a);for(var i=t;n>i;++i)r[i-t]=e[i]}return r},noop:t,error:function(e,t){throw new(t||Error)(e)},oneObject:r,range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n)),i=Array(a);++r<a;)i[r]=e,e+=n;return i},eventHooks:{},bind:function(e,t,n,r){var a=avalon.eventHooks,i=a[t];"object"==typeof i&&(t=i.type,i.deel&&(n=i.deel(e,n)));var o=Lt?n:function(t){n.call(e,tt(t))};return Lt?e.addEventListener(t,o,!!r):e.attachEvent("on"+t,o),o},unbind:function(e,n,r,a){var i=avalon.eventHooks,o=i[n],s=r||t;"object"==typeof o&&(n=o.type),Lt?e.removeEventListener(n,s,!!a):e.detachEvent("on"+n,s)},css:function(e,t,n){e instanceof avalon&&(e=e[0]);var r=/[_-]/.test(t)?T(t):t;if(t=avalon.cssName(r)||r,void 0===n||"boolean"==typeof n){var a=gn[r+":get"]||gn["@:get"],i=a(e,t);return n===!0?parseFloat(i)||0:i}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!avalon.cssNumber[r]&&(n+="px"),a=gn[r+":set"]||gn["@:set"],a(e,t,n)}},each:function(e,t){if(e){var n=0;if(l(e))for(var r=e.length;r>n;n++)t(n,e[n]);else for(n in e)e.hasOwnProperty(n)&&t(n,e[n])}},getWidgetData:function(e,t){var n=avalon(e).data(),r={};for(var a in n)0===a.indexOf(t)&&(r[a.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=n[a]);return r},Array:{ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}}),avalon.nextTick=yt.setImmediate?setImmediate.bind(yt):function(e){setTimeout(e,0)};var Rt=avalon.vmodels={};avalon.define=function(e,r){var a=e.$id||e;if(a||n("warning: vm必须指定$id"),Rt[e]&&n("warning: "+a+" 已经存在于avalon.vmodels中"),"object"==typeof e)var i=c(e);else{var o={$watch:t};r(o),i=c(o),xt=!0,r(i),xt=!1}return i.$id=a,Rt[a]=i};var jt=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$accessors,"+mt).match(Tt),Ft=Object.is||function(e,t){return 0===e&&0===t?1/e===1/t:e!==e?t!==t:e===t},Wt=Lt?function(e){var t={};for(var n in e)t[n]={get:e[n],set:e[n],enumerable:!0,configurable:!0};return t}:function(e){return e},Ut={},Vt=0,zt={},Gt=Object.defineProperty;try{Gt({},"_",{value:"x"});var Xt=Object.defineProperties}catch(Qt){"__defineGetter__"in avalon&&(Gt=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},Xt=function(e,t){for(var n in t)t.hasOwnProperty(n)&&Gt(e,n,t[n]);return e})}if(!Xt&&yt.VBArray&&(yt.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function","Dim VBClassBodies",'Set VBClassBodies=CreateObject("Scripting.Dictionary")',"Function findOrDefineVBClass(name,body)","	Dim found",'	found=""',"	For Each key in VBClassBodies","		If body=VBClassBodies.Item(key) Then","			found=key","			Exit For","		End If","	next",'	If found="" Then','		parseVB("Class " + name + body)',"		VBClassBodies.Add name, body","		found=name","	End If","	findOrDefineVBClass=found","End Function"].join("\n"),"VBScript"),Xt=function(e,t,n){var r="VBClass"+setTimeout("1"),a=[];a.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function");for(e in n)a.push("	Public ["+e+"]");a.push("	Public [hasOwnProperty]");for(e in t)e in n||a.push("	Public Property Let ["+e+"](val"+gt+")",'		Call [__proxy__]([__data__], "'+e+'", val'+gt+")","	End Property","	Public Property Set ["+e+"](val"+gt+")",'		Call [__proxy__]([__data__], "'+e+'", val'+gt+")","	End Property","	Public Property Get ["+e+"]","	On Error Resume Next","		Set["+e+'] = [__proxy__]([__data__],"'+e+'")',"	If Err.Number <> 0 Then","		["+e+'] = [__proxy__]([__data__],"'+e+'")',"	End If","	On Error Goto 0","	End Property");a.push("End Class");var i=a.join("\r\n"),o=yt.findOrDefineVBClass(r,i);o===r&&yt.parseVB(["Function "+r+"Factory(a, b)","	Dim o","	Set o = (New "+r+")(a, b)","	Set "+r+"Factory = o","End Function"].join("\r\n"));var s=yt[o+"Factory"](t,p);return s}),!"司徒正美".trim){var Yt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(Yt,"")}}var qt=!{toString:null}.propertyIsEnumerable("toString"),Jt=function(){}.propertyIsEnumerable("prototype"),Kt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Zt=Kt.length;if(Object.keys||(Object.keys=function(e){var t=[],n=Jt&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var a in e)n&&"prototype"===a||!At.call(e,a)||t.push(String(a));if(qt)for(var i=e.constructor,o=i&&i.prototype===e,s=0;Zt>s;s++){var l=Kt[s];o&&"constructor"===l||!At.call(e,l)||t.push(l)}return t}),Array.isArray||(Array.isArray=function(e){return e&&"array"===avalon.type(e)}),t.bind||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var r,a=[];for(r=1;r<n.length;r++)a.push(n[r]);for(r=0;r<arguments.length;r++)a.push(arguments[r]);return t.apply(e,a)}}),_t.test([].map)||avalon.mix($t,{indexOf:function(e,t){var n=this.length,r=~~t;for(0>r&&(r+=n);n>r;r++)if(this[r]===e)return r;return-1},lastIndexOf:function(e,t){var n=this.length,r=null==t?n-1:t;for(0>r&&(r=Math.max(0,n+r));r>=0;r--)if(this[r]===e)return r;return-1},forEach:v("","_",""),filter:v("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:v("r=[],","r[i]=_","return r"),some:v("","if(_)return true","return false"),every:v("","if(!_)return false","return true")}),Ot.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),e.contains||(e.contains=function(t){return g(e,t)}),yt.SVGElement){var en="http://www.w3.org/2000/svg",tn=document.createElementNS(en,"svg");tn.innerHTML='<circle cx="50" cy="50" r="40" fill="yellow" />',Mt.test(tn.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:m,set:function(e){var t=this.tagName.toLowerCase(),n=this.parentNode,r=avalon.parseHTML(e);if("svg"===t)n.insertBefore(r,this);else{var a=document.createDocumentFragment();y(r,a),n.insertBefore(a,this)}n.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTM){avalon.clearHTML(this);var t=avalon.parseHTML(e);y(t,this)}}}})}!Ot.outerHTML&&yt.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",m);var nn,rn,an,on,sn,ln=/[-.*+?^${}()|[\]\/\\]/g,cn={loader:function(e){yt.define=e?qr.define:bt,yt.require=e?qr:wt},interpolate:function(e){if(nn=e[0],rn=e[1],nn===rn)throw new SyntaxError("openTag!==closeTag");if(e+""=="<!--,-->")w.commentInterpolate=!0;else{var t=nn+"test"+rn;if(Ht.innerHTML=t,Ht.innerHTML!==t&&Ht.innerHTML.indexOf("&lt;")>=0)throw new SyntaxError("此定界符不合法");Ht.innerHTML=""}var n=b(nn),r=b(rn);an=new RegExp(n+"(.*?)"+r),on=new RegExp(n+"(.*?)"+r,"g"),sn=new RegExp(n+".*?"+r+"|\\sms-")}};w.debug=!0,w.plugins=cn,w.plugins.interpolate(["{{","}}"]),w.paths={},w.shim={},w.maxRepeatSize=100,avalon.config=w;var un={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal;return n.split(/\s+/).join(" ")},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," ").trim())},__set:function(e){var t=this.node;"string"==typeof t.className?t.className=e:t.setAttribute("class",e)}};"add,remove".replace(Tt,function(e){avalon.fn[e+"Class"]=function(t){var n=this[0];return t&&"string"==typeof t&&n&&1===n.nodeType&&t.replace(/\S+/g,function(t){_(n)[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&_(t).contains(e)},toggleClass:function(e,t){for(var n,r=0,a=e.split(/\s+/),i="boolean"==typeof t;n=a[r++];){var o=i?t:!this.hasClass(n);this[o?"addClass":"removeClass"](n)}return this},attr:function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(e,t){switch(e="data-"+x(e||""),arguments.length){case 2:return this.attr(e,t),this;case 1:var n=this.attr(e);return C(n);case 0:var r={};return $t.forEach.call(this[0].attributes,function(t){t&&(e=t.name,e.indexOf("data-")||(e=T(e.slice(5)),r[e]=C(t.value)))}),r}},removeData:function(e){return e="data-"+x(e),this[0].removeAttribute(e),this},css:function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var r=avalon.css(this,e,t);return void 0!==r?r:this},position:function(){var e,t,n=this[0],r={top:0,left:0};if(n)return"fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(r=e.offset()),r.top+=avalon.css(e[0],"borderTopWidth",!0),r.left+=avalon.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-avalon.css(n,"marginTop",!0),left:t.left-r.left-avalon.css(n,"marginLeft",!0)}},offsetParent:function(){for(var e=this[0].offsetParent||Ot;e&&"HTML"!==e.tagName&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||Ot)},bind:function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},unbind:function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},val:function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,r=n?":get":":set",a=En[E(t)+r];if(a)var i=a(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?i:this}});var fn=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,dn=/^[\],:{}\s]*$/,hn=/(?:^|:|,)(?:\s*\[)+/g,pn=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,vn=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=yt.JSON?JSON.parse:function(e){if("string"==typeof e){if(e=e.trim(),e&&dn.test(e.replace(pn,"@").replace(vn,"]").replace(hn,"")))return new Function("return "+e)();avalon.error("Invalid JSON: "+e)}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var r=this[0]||{},a=M(r),i="scrollTop"===e;return arguments.length?void(a?a.scrollTo(i?avalon(a).scrollLeft():n,i?n:avalon(a).scrollTop()):r[e]=n):a?t in a?a[t]:Ot[e]:r[e]
}});var gn=avalon.cssHooks={},mn=["","-webkit-","-o-","-moz-","-ms-"],yn={"float":"cssFloat",background:"backgroundColor"};if(avalon.cssNumber=r("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(yn[e])return yn[e];t=t||Ot.style;for(var r=0,a=mn.length;a>r;r++)if(n=T(mn[r]+e),n in t)return yn[e]=n;return null},gn["@:set"]=function(e,t,n){try{e.style[t]=n}catch(r){}},yt.getComputedStyle)gn["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e,null);return r&&(n="filter"===t?r.getPropertyValue(t):r[t],""===n&&(n=e.style[t])),n},gn["opacity:get"]=function(e){var t=gn["@:get"](e,"opacity");return""===t?"1":t};else{var wn=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,bn=/^(top|right|bottom|left)$/,xn=!!yt.XDomainRequest,Tn="DXImageTransform.Microsoft.Alpha",_n={thin:xn?"1px":"2px",medium:xn?"3px":"4px",thick:xn?"5px":"6px"};gn["@:get"]=function(e,t){var n=e.currentStyle,r=n[t];if(wn.test(r)&&!bn.test(r)){var a=e.style,i=a.left,o=e.runtimeStyle.left;e.runtimeStyle.left=n.left,a.left="fontSize"===t?"1em":r||0,r=a.pixelLeft+"px",a.left=i,e.runtimeStyle.left=o}return"medium"===r&&(t=t.replace("Width","Style"),"none"===n[t]&&(r="0px")),""===r?"auto":_n[r]||r},gn["opacity:set"]=function(e,t,n){e.currentStyle.hasLayout||(e.style.zoom=1),e.filters.alpha?e.filters.alpha.opacity=100*n:e.style.filter+="alpha(opacity="+100*n+")"},gn["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[Tn],n=t?t.opacity:100;return n/100+""}}"top,left".replace(Tt,function(e){gn[e+":get"]=function(t){var n=gn["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var Cn={position:"absolute",visibility:"hidden",display:"block"},Mn=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(Tt,function(e){var t=e.toLowerCase(),n="client"+e,r="scroll"+e,a="offset"+e;gn[t+":get"]=function(t,n,r){var i=-4;"number"==typeof r&&(i=r),n="Width"===e?["Left","Right"]:["Top","Bottom"];var o=t[a];return 2===i?o+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(0>i&&(o=o-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),-4===i&&(o=o-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),o)},gn[t+"&get"]=function(e){var n=[];S(e,n);for(var r,a=gn[t+":get"](e),i=0;r=n[i++];){e=r.node;for(var o in r)"string"==typeof r[o]&&(e.style[o]=r[o])}return a},avalon.fn[t]=function(i){var o=this[0];if(0===arguments.length){if(o.setTimeout)return o["inner"+e]||o.document.documentElement[n];if(9===o.nodeType){var s=o.documentElement;return Math.max(o.body[r],s[r],o.body[a],s[a],s[n])}return gn[t+"&get"](o)}return this.css(t,i)},avalon.fn["inner"+e]=function(){return gn[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return gn[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,r=n.body,a=n.documentElement,i=n.defaultView||n.parentWindow;if(!avalon.contains(a,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var o=a.clientTop||r.clientTop,s=a.clientLeft||r.clientLeft,l=Math.max(i.pageYOffset||0,a.scrollTop,r.scrollTop),c=Math.max(i.pageXOffset||0,a.scrollLeft,r.scrollLeft);return{top:t.top+l-o,left:t.left+c-s}};var Sn=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,En={"option:get":function(e){return e.hasAttribute?e.hasAttribute("value")?e.value:e.text.trim():Sn.test(e.outerHTML)?e.value:e.text},"select:get":function(e,t){for(var n,r=e.options,a=e.selectedIndex,i=En["option:get"],o="select-one"===e.type||0>a,s=o?null:[],l=o?a+1:r.length,c=0>a?l:o?a:0;l>c;c++)if(n=r[c],(n.selected||c===a)&&!n.disabled){if(t=i(n),o)return t;s.push(t)}return s},"select:set":function(e,t,n){t=[].concat(t);for(var r,a=En["option:get"],i=0;r=e.options[i++];)(r.selected=t.indexOf(a(r))>=0)&&(n=!0);n||(e.selectedIndex=-1)}},An=/<([\w:]+)/,kn=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,$n=Lt?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,Dn=r("text/javascript","text/ecmascript","application/ecmascript","application/javascript","text/vbscript"),In=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,Ln={area:[1,"<map>"],param:[1,"<object>"],col:[2,"<table><tbody></tbody><colgroup>","</table>"],legend:[1,"<fieldset>"],option:[1,"<select multiple='multiple'>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],text:[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],_default:Lt?[0,""]:[1,"X<div>"]};Ln.optgroup=Ln.option,Ln.tbody=Ln.tfoot=Ln.colgroup=Ln.caption=Ln.thead,Ln.th=Ln.td,Ln.circle=Ln.ellipse=Ln.line=Ln.path=Ln.polygon=Ln.polyline=Ln.rect=Ln.text;var On=e.createElement("script");avalon.parseHTML=function(e){"string"!=typeof e&&(e+=""),e=e.replace(kn,"<$1></$2>").trim();var t,n,r=(An.exec(e)||["",""])[1].toLowerCase(),a=Ln[r]||Ln._default,i=Nt.cloneNode(!1),o=Ht;Lt||(e=e.replace($n,"<br class=msNoScope>$1")),o.innerHTML=a[1]+e+(a[2]||"");var s=o.getElementsByTagName("script");if(s.length)for(var l,c=0;l=s[c++];)(!l.type||Dn[l.type])&&(n=On.cloneNode(!1),$t.forEach.call(l.attributes,function(e){e&&e.specified&&(n[e.name]=e.value)}),n.text=l.text,l.parentNode.replaceChild(n,l));for(c=a[0];c--;o=o.lastChild);if(!Lt){for(s=o.getElementsByTagName("br"),c=0;l=s[c++];)l.className&&"msNoScope"===l.className&&l.parentNode.removeChild(l);for(s=o.all,c=0;l=s[c++];)A(l)&&k(l)}for(;t=o.firstChild;)i.appendChild(t);return i},avalon.innerHTML=function(e,t){if(!Lt&&!$n.test(t)&&!In.test(t))try{return void(e.innerHTML=t)}catch(n){}var r=this.parseHTML(t);this.clearHTML(e).appendChild(r)},avalon.clearHTML=function(e){for(e.textContent="";e.firstChild;)e.removeChild(e.firstChild);return e};var Pn,Nn={$watch:function(e,t){if("function"==typeof t){var n=this.$events[e];n?n.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var n=arguments.length;if(0===n)this.$watch.backup=this.$events,this.$events={};else if(1===n)this.$events[e]=[];else for(var r=this.$events[e]||[],a=r.length;~--a<0;)if(r[a]===t)return r.splice(a,1);return this},$fire:function(e){var t;/^(\w+)!(\S+)$/.test(e)&&(t=RegExp.$1,e=RegExp.$2);for(var n,r=this.$events,a=r[e]||[],i=r.$all||[],o=Dt.call(arguments,1),s=0;n=a[s++];)n.apply(this,o);for(var n,s=0;n=i[s++];)n.apply(this,arguments);var l=r.expr&&Bn(r.expr);if(l){var c=[e].concat(o);if("up"===t||"down"===t||"all"===t){for(var s in avalon.vmodels){var u=avalon.vmodels[s];if(u&&u.$events&&u.$events.expr&&u!==this){var f=Bn(u.$events.expr);if(!f)continue;var d="all"===t?1:"down"===t?l.contains(f):f.contains(l);d&&(f._avalon=u)}}var h=document.getElementsByTagName("*"),p=[];Array.prototype.forEach.call(h,function(e){e._avalon&&(p.push(e._avalon),e._avalon="",e.removeAttribute("_avalon"))}),"up"===t&&p.reverse(),p.forEach(function(e){e.$fire.apply(e,c)})}}}},Hn=/(\w+)\[(avalonctrl)="(\S+)"\]/,Bn=document.querySelector?function(e){return document.querySelector(e)}:function(e){for(var t,n=e.match(Hn),r=document.getElementsByTagName(n[1]),a=0;t=r[a++];)if(t.getAttribute(n[2])===n[3])return t},Rn=/^(duplex|on)$/,jn=[],Fn=new Date;avalon.scan=function(e,t){e=e||Ot;var n=t?[].concat(t):[];P(e,n)};var Wn=r("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),Un=Lt?15:50,Vn=/ms-(\w+)-?(.*)/,zn={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},Gn=r("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");if(!"1"[0])var Xn=X(512),Qn=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Yn=/^['"]/,qn=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,Jn=/&amp;/g,Kn=function(e){var t=e.outerHTML;if("</"===t.slice(0,2)||!t.trim())return[];var n,r,a,i=t.match(qn)[0],o=[];if(Xn[i])return Xn[i];for(;r=Qn.exec(i);){a=r[2],a&&(a=(Yn.test(a)?a.slice(1,-1):a).replace(Jn,"&"));var s=r[1].toLowerCase();n=s.match(Vn);var l={name:s,specified:!0,value:a||""};o.push(l)}return Xn(i,o)};var Zn=/\|\s*(\w+)\s*(\([^)]*\))?/g,er=/\|\|/g,tr=/U2hvcnRDaXJjdWl0/g,nr=/&lt;/g,rr=/&gt;/g,ar="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",ir=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,or=/[^\w$]+/g,sr=new RegExp(["\\b"+ar.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),lr=/\b\d[^,]*/g,cr=/^,+|,+$/g,ur=X(512),fr=function(e){var t=","+e.trim();if(ur[t])return ur[t];var n=e.replace(ir,"").replace(or,",").replace(sr,"").replace(lr,"").replace(cr,"").split(/^$|,+/);return ur(t,G(n))},dr=X(128),hr=/\w\[.*\]|\w\.\w/,pr=/(\$proxy\$[a-z]+)\d+$/,vr={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},gr=yt.JSON&&JSON.stringify||function(e){return'"'+e.replace(/[\\\"\x00-\x1f]/g,function(e){var t=vr[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"'};avalon.parseExprProxy=Y;var mr={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},yr="accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan,dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign";yr.replace(Tt,function(e){mr[e.toLowerCase()]=e});var wr="<style id='avalonStyle'>.avalonHide{ display: none!important }</style>";Pt.insertBefore(avalon.parseHTML(wr),Pt.firstChild);var br=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,xr=/<noscript.*?>([\s\S]+?)<\/noscript>/im,Tr=function(){return new(yt.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},_r=function(e,t,n){var r=e.getAttribute(t);if(r)for(var a,i=0;a=n[i++];)if(a.hasOwnProperty(r)&&"function"==typeof a[r])return a[r]},Cr=avalon.templateCache={};avalon.contains=g;var Mr="autofocus,autoplay,async,allowTransparency,checked,controls,declare,disabled,defer,defaultChecked,defaultSelectedcontentEditable,isMap,loop,multiple,noHref,noResize,noShade,open,readOnly,selected",Sr={};Mr.replace(Tt,function(e){Sr[e.toLowerCase()]=e});var Er=avalon.bindingExecutors={attr:function(t,n,r){function a(e){p&&(e=p.apply(n,[e].concat(d))),avalon.innerHTML(n,e),N(n,d),h&&O(n,function(){h.call(n)})}var i=r.type,o=r.param;if("css"===i)avalon(n).css(o,t);else if("attr"===i){if(Sr[o]){var s=Sr[o];if("boolean"==typeof n[s])return n[s]=!!t}var l=t===!1||null===t||void 0===t;if(!Lt&&mr[o]){o=mr[o];var c=!0}if(l)return n.removeAttribute(o);if(yt.VBArray&&!c)if(A(n))c=!0;else if(!Mt.test(n)){var u=n.attributes||{},f=u[o];c=f?f.expando===!1:null===f}c?n[o]=t:n.setAttribute(o,t)}else if("include"===i&&t){var d=r.vmodels,h=_r(n,"data-include-rendered",d),p=_r(n,"data-include-loaded",d);if("src"===r.param)if(Cr[t])avalon.nextTick(function(){a(Cr[t])});else{var v=Tr();v.onreadystatechange=function(){if(4===v.readyState){var e=v.status;(e>=200&&300>e||304===e||1223===e)&&a(Cr[t]=v.responseText)}},v.open("GET",t,!0),"withCredentials"in v&&(v.withCredentials=!0),v.setRequestHeader("X-Requested-With","XMLHttpRequest"),v.send(null)}else{var g=t&&1===t.nodeType?t:e.getElementById(t);if(g){if("NOSCRIPT"===g.tagName&&!g.innerHTML&&!g.fixIE78){var v=Tr();v.open("GET",location,!1),v.send(null);for(var m=e.getElementsByTagName("noscript"),y=(v.responseText||"").match(br)||[],w=y.length,b=0;w>b;b++){var x=m[b];x&&(x.style.display="none",x.fixIE78=(y[b].match(xr)||["","&nbsp;"])[1])}}avalon.nextTick(function(){a(g.fixIE78||g.value||g.innerText||g.innerHTML)})}}}else Ot.hasAttribute||"string"!=typeof t||"src"!==i&&"href"!==i||(t=t.replace(/&amp;/g,"&")),n[i]=t},"class":function(e,t,n){var r=avalon(t),a=n.type;if("class"===a&&n.oldStyle)r.toggleClass(n.oldStyle,!!e);else switch(n.toggleClass=n._evaluator?!!n._evaluator.apply(t,n._args):!0,n.newClass=n.immobileClass||e,n.oldClass&&n.newClass!==n.oldClass&&r.removeClass(n.oldClass),n.oldClass=n.newClass,a){case"class":r.toggleClass(n.newClass,n.toggleClass);break;case"hover":case"active":if(!n.hasBindEvent){var i="mouseenter",o="mouseleave";"active"===a&&(t.tabIndex=t.tabIndex||-1,i="mousedown",o="mouseup",r.bind("mouseleave",function(){n.toggleClass&&r.removeClass(n.newClass)})),r.bind(i,function(){n.toggleClass&&r.addClass(n.newClass)}),r.bind(o,function(){n.toggleClass&&r.removeClass(n.newClass)}),n.hasBindEvent=!0}}},data:function(e,t,n){var r="data-"+n.param;e&&"object"==typeof e?t[r]=e:t.setAttribute(r,String(e))},repeat:function(e,n,r){if(e){var a=this,i=a.element.parentNode,o=a.proxies,s=Nt.cloneNode(!1);if("del"===e||"move"===e)var l=it(a,n);var c=a.group;switch(e){case"add":for(var u=r,f=a.$repeat.length-1,d=[],h=0,p=u.length;p>h;h++){var v=h+n,g=ct(v,u[h],a,f);o.splice(v,0,g),at(a,s,g,d)}l=it(a,n),i.insertBefore(s,l);for(var m,h=0;m=d[h++];)H(m.nodes,m.vmodels),m.nodes=m.vmodels=null;st(a);break;case"del":var y=o.splice(n,r),s=ot(l,c,r);avalon.clearHTML(s),ut(y);break;case"index":for(var f=o.length-1;r=o[n];n++)r.$index=n,r.$first=0===n,r.$last=n===f;break;case"clear":var w="proxySize"in a?a.proxySize:o.length;if(w){for(var p=w*c,b=0;;){var x=a.element.nextSibling;if(!(x&&p>b))break;i.removeChild(x),b++}ut(o)}break;case"move":var T=o.splice(n,1)[0];T&&(o.splice(r,0,T),s=ot(l,c),l=it(a,r),i.insertBefore(s,l));break;case"set":var g=o[n];g&&(g[g.$itemName]=r);break;case"append":var _=r,C=[],d=[];for(var M in n)n.hasOwnProperty(M)&&"hasOwnProperty"!==M&&C.push(M);if(a.sortedCallback){var S=a.sortedCallback.call(i,C);S&&Array.isArray(S)&&S.length&&(C=S)}for(var M,h=0;M=C[h++];)"hasOwnProperty"!==M&&at(a,s,_[M],d);a.proxySize=C.length,i.insertBefore(s,a.element.nextSibling);for(var m,h=0;m=d[h++];)H(m.nodes,m.vmodels),m.nodes=m.vmodels=null;st(a)}var E=a.renderedCallback||t,A=arguments;O(i,function(){E.apply(i,A),i.oldValue&&"SELECT"===i.tagName&&"index"===e&&avalon(i).val(i.oldValue.split(","))})}},html:function(t,n,r){t=null==t?"":t;var a="group"in r?n.parentNode:n;if("group"in r){var i,o;if(11===t.nodeType)i=t;else if(1===t.nodeType||t.item)for(o=1===t.nodeType?t.childNodes:t.item?t:[],i=Nt.cloneNode(!0);o[0];)i.appendChild(o[0]);else i=avalon.parseHTML(t);if(o=avalon.slice(i.childNodes),0===o.length){var s=e.createComment("ms-html");i.appendChild(s),o=[s]}a.insertBefore(i,n);for(var l=r.group;n;){var c=n.nextSibling;if(a.removeChild(n),l--,0===l||null===c)break;n=c}r.element=o[0],r.group=o.length}else avalon.innerHTML(a,t);avalon.nextTick(function(){N(a,r.vmodels)})},"if":function(t,n,r){if(t)8===n.nodeType&&(n.parentNode.replaceChild(r.template,n),n=r.element=r.template,r.template=null),n.getAttribute(r.name)&&(n.removeAttribute(r.name),F(n,r.vmodels));else if(1===n.nodeType){var a=e.createComment("ms-if");n.parentNode.replaceChild(a,n),r.element=a,Pt.appendChild(n),r.template=n}},on:function(e,n,r){r.type="on",e=function(e){var n=r.evaluator||t;return n.apply(this,r.args.concat(e))};var a=r.param.replace(/-\d+$/,"");if("scan"===a)e.call(n,{type:a});else if("function"==typeof r.specialBind)r.specialBind(n,e);else var i=avalon.bind(n,a,e);r.rollback=function(){"function"==typeof r.specialUnbind?r.specialUnbind():avalon.unbind(n,a,i)}},text:function(e,t){if(e=null==e?"":e,3===t.nodeType)try{t.data=e}catch(n){}else"textContent"in t?t.textContent=e:t.innerText=e},visible:function(e,t,n){t.style.display=e?n.display:"none"},widget:t},Ar=/\(([^)]*)\)/;avalon.parseDisplay=q;var kr=avalon.bindingHandlers={attr:function(e,t){var n=e.value.trim(),r=!0;n.indexOf(nn)>-1&&n.indexOf(rn)>2&&(r=!1,an.test(n)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(r=!0,n=RegExp.$1)),e.handlerName="attr",Y(n,t,e,r?null:V(e.value))},"class":function(e,t){var r,a=e.param,i=e.value;if(e.handlerName="class",!a||isFinite(a)){e.param="";var o=i.replace(on,function(e){return Math.pow(10,e.length-1)}),s=o.indexOf(":");if(-1===s)var l=i;else{if(l=i.slice(0,s),r=i.slice(s+1),Q(r,t,e),!e.evaluator)return n("debug: ms-class '"+(r||"").trim()+"' 不存在于VM中"),!1;e._evaluator=e.evaluator,e._args=e.args}var c=an.test(l);c||(e.immobileClass=l),Y("",t,e,c?V(l):null)}else e.immobileClass=e.oldStyle=e.param,Y(i,t,e)},duplex:function(e,n){var r=e.element,a=r.tagName;if("function"==typeof $r[a]&&(e.changed=_r(r,"data-duplex-changed",n)||t,Q(e.value,n,e,"duplex"),e.evaluator&&e.args)){var i=r.form;i&&i.msValidate&&i.msValidate(r),e.bound=function(t,n){r.addEventListener?r.addEventListener(t,n,!1):r.attachEvent("on"+t,n);var a=e.rollback;e.rollback=function(){avalon.unbind(r,t,n),a&&a()}},$r[r.tagName](r,e.evaluator.apply(null,e.args),e)}},repeat:function(t,n){var r=t.type;Q(t.value,n,t),t.proxies=[];var a=!1;try{var i=t.$repeat=t.evaluator.apply(0,t.args||[]),o=avalon.type(i);"object"!==o&&"array"!==o&&(a=!0,avalon.log("warning:"+t.value+"对应类型不正确"))}catch(s){a=!0,avalon.log("warning:"+t.value+"编译出错")}var l=t.element;l.removeAttribute(t.name),t.sortedCallback=_r(l,"data-with-sorted",n),t.renderedCallback=_r(l,"data-"+r+"-rendered",n);var c=t.element=e.createComment("ms-repeat");"each"===r||"with"===r?(t.template=l.innerHTML.trim(),avalon.clearHTML(l).appendChild(c)):(t.template=l.outerHTML.trim(),t.group=1,l.parentNode.replaceChild(c,l)),t.rollback=function(){Er.repeat.call(t,"clear");var e=t.element,n=e.parentNode,r=avalon.parseHTML(t.template),a=r.firstChild;n.replaceChild(r,e),a=t.element="repeat"===t.type?a:n,t.group=null,a.setAttribute(t.name,t.value)};var u=t.value.split(".")||[];if(u.length>1){u.pop();for(var f,d=u[0],h=0;f=n[h++];)if(f&&f.hasOwnProperty(d)&&f[d][mt]){f[d][mt].push(t);break}}if(!a){t.handler=Er.repeat,t.$outer={};var p="$key",v="$val";Array.isArray(i)&&(p="$first",v="$last");for(var g,h=0;g=n[h++];)if(g.hasOwnProperty(p)&&g.hasOwnProperty(v)){t.$outer=g;break}var m=i[mt];if(m&&(m.push(t),jn.push({data:t,list:m})),Array.isArray(i)||"each"===r)t.handler("add",0,i);else{var y=Ut[i.$id];if(!y){Vt++,y=Ut[i.$id]={};for(var w in i)i.hasOwnProperty(w)&&"hasOwnProperty"!==w&&!function(e,t){y[e]=lt(e,t,{}),y[e].$watch("$val",function(t){i[e]=t})}(w,i[w])}t.handler("append",i,y)}}},html:function(e,t){Y(e.value,t,e)},on:function(e,t){var n=e.value,r=e.param.replace(/-\d+$/,"");if("function"==typeof kr.on[r+"Hook"]&&kr.on[r+"Hook"](e),n.indexOf("(")>0&&n.indexOf(")")>-1){var a=(n.match(Ar)||["",""])[1].trim();(""===a||"$event"===a)&&(n=n.replace(Ar,""))}Y(n,t,e)},visible:function(e,t){var n=avalon(e.element),r=n.css("display");if("none"===r){var a=n[0].style,i=/visibility/i.test(a.cssText),o=n.css("visibility");a.display="",a.visibility="hidden",r=n.css("display"),"none"===r&&(r=q(n[0].nodeName)),a.visibility=i?o:""}e.display=r,Y(e.value,t,e)},widget:function(e,n){function r(){return i.msRetain||Ot.contains(i)?void 0:(v.$remove(),i.msData={},delete Rt[v.$id],!1)}var a=e.value.match(Tt),i=e.element,o=a[0];"$"!==a[1]&&a[1]||(a[1]=o+setTimeout("1")),e.value=a.join(",");var s=avalon.ui[o];if("function"==typeof s){n=i.vmodels||n;for(var l,c=a[2]||o,u=0;l=n[u++];)if(l.hasOwnProperty(c)&&"object"==typeof l[c]){var f=l;break}if(f){var d=f[c];d=d.$model||d;var h=d[o+"Id"];"string"==typeof h&&(a[1]=h)}var p=avalon.getWidgetData(i,a[0]);e[o+"Id"]=a[1],e[o+"Options"]=avalon.mix({},s.defaults,d||{},p),i.removeAttribute("ms-widget");var v=s(i,e,n)||{};e.evaluator=t,i.msData["ms-widget-id"]=v.$id||"",v.hasOwnProperty("$init")&&v.$init(),v.hasOwnProperty("$remove")&&(yt.chrome?i.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(r)}):avalon.tick(r))}else n.length&&(i.vmodels=n)}};"hover,active".replace(Tt,function(e){kr[e]=kr["class"]}),"with,each".replace(Tt,function(e){kr[e]=kr.repeat}),kr["if"]=kr.data=kr.text=kr.html,"title,alt,src,value,css,include,href".replace(Tt,function(e){kr[e]=kr.attr});var $r=kr.duplex;$r.INPUT=function(t,n,r){function a(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||("cut"===e.type?avalon.nextTick(p):p())}var i=r.param,o=t.type,s=r.bound,l=avalon(t),c=!1,u=!1,f=function(e){c=!0,r.changed.call(this,e)},d=function(){u=!0},h=function(){u=!1},p=function(){if(!u){var e=t.oldValue=t.value;l.data("duplex-observe")!==!1&&(n(e),f.call(t,e))}};if(r.handler=function(){var e=n();e=null==e?"":e+"",e!==t.value&&(t.value=e)},"checkbox"===o&&"radio"===i&&(o="radio"),"radio"===o)r.handler=function(){t.defaultChecked=t.checked=/bool|text/.test(i)?n()+""===t.value:!!n()},p=function(){if(l.data("duplex-observe")!==!1){var e=t.value;"text"===i?n(e):"bool"===i?(e="true"===e,n(e)):(e=!t.defaultChecked,n(e),t.checked=e),f.call(t,e)}},s(i?"click":"mousedown",p);else if("checkbox"===o)p=function(){if(l.data("duplex-observe")!==!1){var e=t.checked?"ensure":"remove",r=n();Array.isArray(r)?avalon.Array[e](r,t.value):avalon.error("ms-duplex位于checkbox时要求对应一个数组"),f.call(t,r)}},r.handler=function(){var e=[].concat(n());t.checked=e.indexOf(t.value)>=0},s(Lt?"change":"click",p);else{var v=t.attributes["data-duplex-event"]||t.attributes["data-event"]||{};if(v=v.value,"change"===v)s("change",p);else if(Lt&&9!==e.documentMode)s("input",p),s("compositionstart",d),s("compositionend",h);else{var g=["keyup","paste","cut","change"];g.forEach(function(e){t.attachEvent("on"+e,a)}),r.rollback=function(){g.forEach(function(e){t.detachEvent("on"+e,a)})}}}t.oldValue=t.value,Lr(function(){if(avalon.contains(Ot,t))K.call(t);else if(!t.msRetain)return!1}),$(r);var m=setTimeout(function(){c||f.call(t,t.value),clearTimeout(m)},31)};var Dr,Ir=[],Lr=t;avalon.tick=function(e){1===Ir.push(e)&&(Dr=setInterval(Z,60))};try{var Or=HTMLInputElement.prototype;Object.getOwnPropertyNames(Or);var Pr=Object.getOwnPropertyDescriptor(Or,"value").set;Object.defineProperty(Or,"value",{set:et})}catch(Qt){Lr=avalon.tick}$r.SELECT=function(e,t,n){function r(){if(a.data("duplex-observe")!==!1){var r=a.val();r+""!==e.oldValue&&(t(r),e.oldValue=r+""),n.changed.call(e,r)}}var a=avalon(e);n.handler=function(){var n=t();n=n&&n.$model||n,n=Array.isArray(n)?n.map(String):n+"",n+""!==e.oldValue&&(a.val(n),e.oldValue=n+"")},n.bound("change",r);var i=0/0,o=setInterval(function(){var r=e.innerHTML;r===i?(clearInterval(o),$(n),n.changed.call(e,t())):i=r},20)},$r.TEXTAREA=$r.INPUT;var Nr=avalon.eventHooks;if("onmouseenter"in Ot||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Nr[e]={type:t,deel:function(t,n){return function(r){var a=r.relatedTarget;return a&&(a===t||16&t.compareDocumentPosition(a))?void 0:(delete r.type,r.type=e,n.call(t,r))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){yt[e]&&!Nr.animationend&&(Nr.animationend={type:t})}),"oninput"in document.createElement("input")||(Nr.input={type:"propertychange",deel:function(e,t){return function(n){return"value"===n.propertyName?(n.type="input",t.call(e,n)):void 0}}}),void 0===document.onmousewheel){var Hr=void 0!==document.onwheel?"wheel":"DOMMouseScroll",Br="wheel"===Hr?"deltaY":"detail";Nr.mousewheel={type:Hr,deel:function(e,t){return function(n){n.wheelDeltaY=n.wheelDelta=n[Br]>0?-120:120,n.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(n,"type",{value:"mousewheel"}),t.call(e,n)}}}}var Rr=$t.splice,jr={_splice:Rr,_add:function(e,t){var n=this.length;t="number"==typeof t?t:n;for(var r=[],a=0,i=e.length;i>a;a++)r[a]=rt(e[a]);return Rr.apply(this,[t,0].concat(r)),L(this,"add",t,r),this._stopFireLength?void 0:this._.length=this.length},_del:function(e,t){var n=this._splice(e,t);return n.length&&(L(this,"del",e,t),this._stopFireLength||(this._.length=this.length)),n},push:function(){$t.push.apply(this.$model,arguments);var e=this._add(arguments);return L(this,"index",e>2?e-2:0),e},pushArray:function(e){return this.push.apply(this,e)},unshift:function(){return $t.unshift.apply(this.$model,arguments),this._add(arguments,0),L(this,"index",arguments.length),this.$model.length},shift:function(){var e=this.$model.shift();return this._del(0,1),L(this,"index",0),e},pop:function(){var e=this.$model.pop();return this._del(this.length-1,1),e},splice:function(e){e=s(e,this.length);var t,n=Rr.apply(this.$model,arguments),r=[];return this._stopFireLength=!0,n.length&&(r=this._del(e,n.length),t=!0),arguments.length>2&&(this._add(Dt.call(arguments,2),e),t=!0),this._stopFireLength=!1,this._.length=this.length,t&&L(this,"index",0),r},contains:function(e){return-1!==this.indexOf(e)},size:function(){return this._.length},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>=0?this.splice(e,1):[]},clear:function(){return this.$model.length=this.length=this._.length=0,L(this,"clear",0),this},removeAll:function(e){if(Array.isArray(e))e.forEach(function(e){this.remove(e)},this);else if("function"==typeof e)for(var t=this.length-1;t>=0;t--){var n=this[t];e(n,t)&&this.splice(t,1)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(e>=0){var n=avalon.type(t);t&&t.$model&&(t=t.$model);var r=this[e];if("object"===n)for(var a in t)r.hasOwnProperty(a)&&(r[a]=t[a]);else"array"===n?r.clear().push.apply(r,t):r!==t&&(this[e]=t,this.$model[e]=t,L(this,"set",e,t))}return this}};"sort,reverse".replace(Tt,function(e){jr[e]=function(){var t=this.$model,n=t.slice(0),r=!1;$t[e].apply(t,arguments);for(var a=0,i=n.length;i>a;a++){var o=t[a],s=n[a];if(!Ft(o,s)){r=!0;var l=n.indexOf(o,a),c=this._splice(l,1)[0],u=n.splice(l,1)[0];this._splice(a,0,c),n.splice(a,0,u),L(this,"move",l,a)}}return n=void 0,r&&L(this,"index",0),this}});var Fr=r("$index,$first,$last"),Wr=[],Ur=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,Vr=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,zr=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,Gr={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},Xr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Qr=/([^\#-~| |!])/g,Yr=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n=void 0===n?"...":n,e.length>t?e.slice(0,t-n.length)+n:String(e)},camelize:T,sanitize:function(e){return e.replace(Ur,"").replace(zr,function(e){var t=e.toLowerCase().match(/<(\w+)\s/);if(t){var n=Gr[t[1]];n&&(e=e.replace(n,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r}))}return e.replace(Vr," ").replace(/\s+/g," ")})},escape:function(e){return String(e).replace(/&/g,"&amp;").replace(Xr,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(Qr,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(e,t){return t=t||"￥",t+avalon.filters.number(e)},number:function(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,i=isFinite(+t)?Math.abs(t):0,o=r||",",s=n||".",l="",c=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return l=(i?c(a,i):""+Math.round(a)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(l[1]||"").length<i&&(l[1]=l[1]||"",l[1]+=new Array(i-l[1].length+1).join("0")),l.join(s)}};!new function(){function e(e){return parseInt(e,10)}function t(e,t,n){var r="";for(0>e&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function n(e,n,r,a){return function(i){var o=i["get"+e]();return(r>0||o>-r)&&(o+=r),0===o&&-12===r&&(o=12),t(o,n,a)}}function r(e,t){return function(n,r){var a=n["get"+e](),i=(t?"SHORT"+e:e).toUpperCase();return r[i][a]}}function a(e){var n=-1*e.getTimezoneOffset(),r=n>=0?"+":"";return r+=t(Math[n>0?"floor":"ceil"](n/60),2)+t(Math.abs(n%60),2)}function i(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function o(t){var n;if(n=t.match(u)){var r=new Date(0),a=0,i=0,o=n[8]?r.setUTCFullYear:r.setFullYear,s=n[8]?r.setUTCHours:r.setHours;n[9]&&(a=e(n[9]+n[10]),i=e(n[9]+n[11])),o.call(r,e(n[1]),e(n[2])-1,e(n[3]));var l=e(n[4]||0)-a,c=e(n[5]||0)-i,f=e(n[6]||0),d=Math.round(1e3*parseFloat("0."+(n[7]||0)));return s.call(r,l,c,f,d),r}return t}var s={yyyy:n("FullYear",4),yy:n("FullYear",2,0,!0),y:n("FullYear",1),MMMM:r("Month"),MMM:r("Month",!0),MM:n("Month",2,1),M:n("Month",1,1),dd:n("Date",2),d:n("Date",1),HH:n("Hours",2),H:n("Hours",1),hh:n("Hours",2,-12),h:n("Hours",1,-12),mm:n("Minutes",2),m:n("Minutes",1),ss:n("Seconds",2),s:n("Seconds",1),sss:n("Milliseconds",3),EEEE:r("Day"),EEE:r("Day",!0),a:i,Z:a},l=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,c=/^\d+$/,u=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,f=/^(\d+)-(\d+)-(\d{4})$/,d=/^(\d+)\s+(\d+),(\d{4})$/;Yr.date=function(t,n){var r,a,i=Yr.date.locate,u="",h=[];if(n=n||"mediumDate",n=i[n]||n,"string"==typeof t){if(c.test(t))t=e(t);else{var p=t.trim();(p.match(f)||p.match(d))&&(t=RegExp.$3+"/"+RegExp.$1+"/"+RegExp.$2),t=o(t)}t=new Date(t)}if("number"==typeof t&&(t=new Date(t)),"date"===avalon.type(t)){for(;n;)a=l.exec(n),a?(h=h.concat(a.slice(1)),n=h.pop()):(h.push(n),n=null);return h.forEach(function(e){r=s[e],u+=r?r(t,i):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}};var h={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};h.SHORTMONTH=h.MONTH,Yr.date.locate=h};var qr,Jr=avalon.modules={"ready!":{exports:avalon},avalon:{exports:avalon,state:2}};!new function(){function r(e){return(e||"").replace(/[?#].*/,"")}function i(t){var n;try{a.b.c()}catch(r){n=r.stack,!n&&yt.opera&&(n=(String(r).match(/of linked script \S+/g)||[]).join(" "))}if(n)return n=n.split(/[@ ]/g).pop(),n="("===n[0]?n.slice(1,-1):n.replace(/\s/,""),n.replace(/(:\d+)?:\d+$/i,"");for(var i,o=(t?e:Pt).getElementsByTagName("script"),s=o.length;i=o[--s];)if((t||i.className===mt)&&"interactive"===i.readyState)return i.className=i.src}function o(e,t){for(var n in e)if("司徒正美"===e[n]&&2!==Jr[n].state&&(n===t||o(Jr[n].deps,t)))return!0}function s(){e:for(var e,t=h.length;e=h[--t];){var n=Jr[e],r=n.deps;for(var a in r)if(At.call(r,a)&&2!==Jr[a].state)continue e;2!==n.state&&(h.splice(t,1),f(n.id,n.args,n.factory),s())}}function l(e,t,a){var i=r(e.src);return e.onload=e.onreadystatechange=e.onerror=null,t||a&&!Jr[i].state?(setTimeout(function(){Pt.removeChild(e),e=null}),void n("debug: 加载 "+i+" 失败"+t+" "+!Jr[i].state)):!0}function c(e,n,a,i){if("ready!"===e||Jr[e]&&2===Jr[e].state)return e;var o;if(e=e.replace(/^\w+!/,function(e){return o=e.slice(0,-1),""}),o=o||"js",o=cn[o]||t,"object"==typeof w.shim[e]&&(i=w.shim[e]),w.paths[e]&&(e=w.paths[e]),/^(\w+)(\d)?:.*/.test(e))a=e;else{n=n.substr(0,n.lastIndexOf("/"));var s=e.charAt(0);if("."!==s&&"/"!==s)a=d+e;else if("./"===e.slice(0,2))a=n+e.slice(1);else if(".."===e.slice(0,2))for(a=n+"/"+e;m.test(a);)a=a.replace(m,"");else"/"===s?a=e:avalon.error("不符合模块标识规则: "+e)}e=r(a);var l=o.ext;return l&&e.slice(0-l.length)!==l&&(a+=l),w.nocache&&(a+=(-1===a.indexOf("?")?"?":"&")+(new Date-0)),o(a,i)}function u(t,r,a){var i=e.createElement("script");i.className=mt,i[Lt?"onload":"onreadystatechange"]=function(){if(Lt||/loaded|complete/i.test(i.readyState)){var e=p.pop();e&&e.delay(r),a&&a(),l(i,!1,!Lt)&&n("debug: 已成功加载 "+t)}},i.onerror=function(){l(i,!0)},i.src=t,Pt.insertBefore(i,Pt.firstChild),n("debug: 正准备加载 "+t)}function f(e,t,n){for(var r,a=0,i=[];r=t[a++];)i.push(Jr[r].exports);var o=Object(Jr[e]),s=n.apply(yt,i);
return o.state=2,void 0!==s&&(Jr[e].exports=s),s}var d,h=[],p=[];cn.js=function(e,t){var n=r(e);return Jr[n]||(Jr[n]={id:n,exports:{}},t?qr(t.deps||"",function(){u(e,n,function(){Jr[n].state=2,t.exports&&(Jr[n].exports="function"==typeof t.exports?t.exports():yt[t.exports]),qr.checkDeps()})}):u(e,n)),n},cn.css=function(t){var n=t.replace(/(#.+|\W)/g,"");if(!e.getElementById(n)){var r=e.createElement("link");r.rel="stylesheet",r.href=t,r.id=n,Pt.insertBefore(r,Pt.firstChild)}},cn.css.ext=".css",cn.js.ext=".js",cn.text=function(e){var t=Tr(),n=e.replace(/[?#].*/,"");return Jr[n]={},t.onreadystatechange=function(){if(4===t.readyState){var r=t.status;r>399&&600>r?avalon.error(e+" 对应资源不存在或没有开启 CORS"):(Jr[n].state=2,Jr[n].exports=t.responseText,qr.checkDeps())}},t.open("GET",e,!0),"withCredentials"in t&&(t.withCredentials=!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send(),n};var v=i(!0);v||(v=avalon.slice(e.scripts).pop().src);var g=r(v);d=w.base=g.slice(0,g.lastIndexOf("/")+1);var m=/\/\w+\/\.\./;qr=avalon.require=function(e,t,n){var r={},a=[],i=0,o=0,l=n||"callback"+setTimeout("1");n=n||d,String(e).replace(Tt,function(e){var t=c(e,n);t&&(i++,Jr[t]&&2===Jr[t].state&&o++,r[t]||(a.push(t),r[t]="司徒正美"))}),Jr[l]={id:l,factory:t,deps:r,args:a,state:1},i===o?f(l,a,t):h.unshift(l),s()},qr.define=function(e,t,n){var a=Dt.call(arguments);if("string"==typeof e)var s=a.shift();"function"==typeof a[0]&&a.unshift([]);var l=Jr[s]&&Jr[s].state>=1?s:r(i());!Jr[l]&&s&&(Jr[l]={id:l,factory:n,state:1}),n=a[1],n.id=s,n.delay=function(e){a.push(e);var t=!0;try{t=o(Jr[e].deps,e)}catch(r){}t&&avalon.error(e+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+e+"模块"),delete n.delay,qr.apply(null,a)},l?n.delay(l,a):p.push(n)},qr.define.amd=Jr,qr.config=w,qr.checkDeps=s};var Kr=[];"complete"===e.readyState?setTimeout(ht):Lt?e.addEventListener("DOMContentLoaded",ht):(e.attachEvent("onreadystatechange",function(){"complete"===e.readyState&&ht()}),Ot.doScroll&&pt()),avalon.bind(yt,"load",ht),avalon.ready=function(e){qr?qr("ready!",e):ht===t?e(avalon):Kr.push(e)},avalon.config({loader:!0}),avalon.ready(function(){function t(){var e=n.shift();e&&(e(),n.length&&avalon.nextTick())}if(yt.VBArray&&!yt.setImmediate){var n=[];avalon.nextTick=function(r){"function"==typeof r&&n.push(r);var a=e.createElement("script");a.onreadystatechange=function(){t(),a.onreadystatechange=null,Pt.removeChild(a),a=null},Pt.appendChild(a)}}avalon.scan(e.body)})}(document),!function(e){function t(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}function n(){return[20*Math.random()-10,20*Math.random()-10]}function r(e){var t=e.css("position");return"relative"===t||"fixed"===t||"absolute"===t?!0:!1}function a(e){e.preventDefault()}function i(t){var n=this;return e.isArray(n)&&e(this).length||(n=e("body")),n.each(function(){var r=e(this),a=r.data("fz.cover");a||r.data("fz.cover",a=new s(this,e.extend({},o,"object"==typeof t&&t,r.data()))),"string"==typeof t&&a[t].call(n)})}var o={trigger:null,dismiss:null,duration:1e3,startPos:"source",offset:[0,0],expandAxis:"y",isFloat:!0,zIndex:999,callback:function(){}},s=function(t,n){this.element=e(t),this.trigger=e(n.trigger),this.dismiss=e(n.dismiss),this.option=n,this.initMask(),this.render(),this._isShown=!1,this._isDismiss=!1,this._bindTrigger(),this.position||(this.position={},this.position.screenWidth=document.documentElement.clientWidth,this.position.screenHeight=document.documentElement.clientHeight)};s.prototype={initMask:function(){this._mask=e("<div></div>"),this._mask.css({position:"absolute",top:0,left:0,width:100,height:100,"z-index":-1,"-webkit-transform":"scale(0)"})},render:function(){this._mask.appendTo(this.element),r(this.element)||this.element.css({position:"relative",overflow:"hidden"})},setConfig:function(t){return this._isShown||(t=e.extend(t,this.currentTrigger.data()),this.currentOption=t),this},show:function(e){var r=this,a=this.currentOption;if(!this._isShown&&(this.currentTrigger||e)){e&&(this.currentTrigger=e),a.callback("show",r),this._preventDefault(),r._isDismiss=!1,this._isShown=!0;var i=n(),o=2;a.isFloat&&(this._floatTrigger(),this.currentTrigger.css({zIndex:a.zIndex+1}));var s=this._getMaskPos(a.startPos,a.expandAxis),l="x"==a.expandAxis?"scale(0,1)":"y"==a.expandAxis?"scale(1,0)":"scale(0,0)";this._mask.css({left:s[0]+a.offset[0],top:s[1]+a.offset[1],background:a.background?a.background:t(),"z-index":a.zIndex,"-webkit-transform":l+" skew("+i[0]+"deg,"+i[1]+"deg)"}),this._aniMask(a.duration,a.offset,o)}return this},hide:function(){var e=this;e.option.callback("hide",e),this._isShown&&(this._isDismiss=!0,this._mask.css({"-webkit-transform":this._originTransform}))},hidden:function(){this._isShown=!1,this._isDismiss=!1,this._mask.css({"-webkit-transition":"none"}),this._relaseDefault(),this.currentTrigger.css(this._triggerOriginCss)},_bindTrigger:function(){var t=this;this.trigger.on("tap",function(){return t._isShown||(t.currentTrigger=e(this)),t.setConfig(e.extend({},e(this).data(),t.option)).show(e(this)),!1}),this.dismiss.on("tap",function(){return t.dismiss=e(this),t.hide(),!1}),this._mask[0].addEventListener("webkitTransitionEnd",function(){t._isShown&&!t._isDismiss?t.option.callback("shown",t):(t.hidden(),t.option.callback("hidden",t))},!1)},_preventDefault:function(){document.addEventListener("mousewheel",a,!1),document.body.addEventListener("touchmove",a,!1),document.documentElement.addEventListener("touchmove",a,!1)},_relaseDefault:function(){document.removeEventListener("mousewheel",a,!1),document.body.removeEventListener("touchmove",a,!1),document.documentElement.removeEventListener("touchmove",a,!1)},_floatTrigger:function(){this._triggerOriginCss={position:this.currentTrigger.css("position"),"z-index":this.currentTrigger.css("z-index")},r(this.currentTrigger)||this.currentTrigger.css({position:"relative"})},_getMaskPos:function(e,t){this.position||(this.position={},this.position.screenWidth=document.documentElement.clientWidth,this.position.screenHeight=document.documentElement.clientHeight),"x"==t?this._mask.css({height:this.position.screenHeight}):"y"==t&&this._mask.css({width:this.position.screenWidth}),this.position.scrollTop=document.body.scrollTop,this.position.scrollLeft=document.body.scrollLeft,this.position.offsetTop=this.element.offset().top,this.position.offsetLeft=this.element.offset().left,this.position.triggerLeft=this.currentTrigger.offset().left,this.position.triggerTop=this.currentTrigger.offset().top,this.position.triggerHeight=this.currentTrigger.height(),this.position.triggerWidth=this.currentTrigger.width();var n=parseInt(this._mask.css("width")),r=parseInt(this._mask.css("height")),a=this.position.scrollLeft-this.position.offsetLeft+this.position.screenWidth/2-n/2,i=0;return"top"==e?i=this.position.scrollTop-this.position.offsetTop-r/2:"bottom"==e?i=this.position.scrollTop-this.position.offsetTop+this.position.screenHeight-r/2:"center"==e?i=this.position.scrollTop-this.position.offsetTop+this.position.screenHeight/2-r/2:(a=this.position.triggerLeft-this.position.offsetLeft+this.position.triggerWidth/2-n/2,i=this.position.triggerTop-this.position.offsetTop+this.position.triggerHeight/2-r/2),[a,i]},_aniMask:function(e,t,n){var r=this;this._originTransform=this._mask.css("-webkit-transform");var a=Math.ceil(this.position.screenWidth/parseInt(this._mask.css("width")))*n,i=Math.ceil(this.position.screenHeight/parseInt(this._mask.css("height")))*n;setTimeout(function(){r._mask.css({"-webkit-transition":"all "+e+"ms","-webkit-transform":"scale("+a+","+i+") skew(0deg,0deg)"})},200)}},e.fn.cover=e.cover=i}(window.Zepto);var QRCode;!function(){function e(e){this.mode=c.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=[],n=0,r=this.data.length;r>n;n++){var a=this.data.charCodeAt(n);a>65536?(t[0]=240|(1835008&a)>>>18,t[1]=128|(258048&a)>>>12,t[2]=128|(4032&a)>>>6,t[3]=128|63&a):a>2048?(t[0]=224|(61440&a)>>>12,t[1]=128|(4032&a)>>>6,t[2]=128|63&a):a>128?(t[0]=192|(1984&a)>>>6,t[1]=128|63&a):t[0]=a,this.parsedData=this.parsedData.concat(t)}this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var r=0;r<e.length-n;r++)this.num[r]=e[r+n]}function r(e,t){this.totalCount=e,this.dataCount=t}function a(){this.buffer=[],this.length=0}function i(){return"undefined"!=typeof CanvasRenderingContext2D}function o(){var e=!1,t=navigator.userAgent;return/android/i.test(t)&&(e=!0,aMat=t.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(e=parseFloat(aMat[1]))),e}function s(e,t){for(var n=1,r=l(e),a=0,i=v.length;i>=a;a++){var o=0;switch(t){case u.L:o=v[a][0];break;case u.M:o=v[a][1];break;case u.Q:o=v[a][2];break;case u.H:o=v[a][3]}if(o>=r)break;n++}if(n>v.length)throw new Error("Too long data");return n}function l(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}e.prototype={getLength:function(){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;n>t;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(0>e||this.moduleCount<=e||0>t||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[r][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;7>=n;n++)if(!(-1>=e+n||this.moduleCount<=e+n))for(var r=-1;7>=r;r++)-1>=t+r||this.moduleCount<=t+r||(this.modules[e+n][t+r]=n>=0&&6>=n&&(0==r||6==r)||r>=0&&6>=r&&(0==n||6==n)||n>=2&&4>=n&&r>=2&&4>=r?!0:!1)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;8>n;n++){this.makeImpl(!0,n);var r=d.getLostPoint(this);(0==n||e>r)&&(e=r,t=n)}return t},createMovieClip:function(e,t,n){var r=e.createEmptyMovieClip(t,n),a=1;this.make();for(var i=0;i<this.modules.length;i++)for(var o=i*a,s=0;s<this.modules[i].length;s++){var l=s*a,c=this.modules[i][s];c&&(r.beginFill(0,100),r.moveTo(l,o),r.lineTo(l+a,o),r.lineTo(l+a,o+a),r.lineTo(l,o+a),r.endFill())}return r},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=0==e%2);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var e=d.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var r=e[t],a=e[n];if(null==this.modules[r][a])for(var i=-2;2>=i;i++)for(var o=-2;2>=o;o++)this.modules[r+i][a+o]=-2==i||2==i||-2==o||2==o||0==i&&0==o?!0:!1}},setupTypeNumber:function(e){for(var t=d.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var r=!e&&1==(1&t>>n);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(var n=0;18>n;n++){var r=!e&&1==(1&t>>n);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,r=d.getBCHTypeInfo(n),a=0;15>a;a++){var i=!e&&1==(1&r>>a);6>a?this.modules[a][8]=i:8>a?this.modules[a+1][8]=i:this.modules[this.moduleCount-15+a][8]=i}for(var a=0;15>a;a++){var i=!e&&1==(1&r>>a);8>a?this.modules[8][this.moduleCount-a-1]=i:9>a?this.modules[8][15-a-1+1]=i:this.modules[8][15-a-1]=i}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,r=this.moduleCount-1,a=7,i=0,o=this.moduleCount-1;o>0;o-=2)for(6==o&&o--;;){for(var s=0;2>s;s++)if(null==this.modules[r][o-s]){var l=!1;i<e.length&&(l=1==(1&e[i]>>>a));var c=d.getMask(t,r,o-s);c&&(l=!l),this.modules[r][o-s]=l,a--,-1==a&&(i++,a=7)}if(r+=n,0>r||this.moduleCount<=r){r-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,i){for(var o=r.getRSBlocks(e,n),s=new a,l=0;l<i.length;l++){var c=i[l];s.put(c.mode,4),s.put(c.getLength(),d.getLengthInBits(c.mode,e)),c.write(s)}for(var u=0,l=0;l<o.length;l++)u+=o[l].dataCount;if(s.getLengthInBits()>8*u)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*u+")");for(s.getLengthInBits()+4<=8*u&&s.put(0,4);0!=s.getLengthInBits()%8;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*u)&&(s.put(t.PAD0,8),!(s.getLengthInBits()>=8*u));)s.put(t.PAD1,8);return t.createBytes(s,o)},t.createBytes=function(e,t){for(var r=0,a=0,i=0,o=new Array(t.length),s=new Array(t.length),l=0;l<t.length;l++){var c=t[l].dataCount,u=t[l].totalCount-c;a=Math.max(a,c),i=Math.max(i,u),o[l]=new Array(c);for(var f=0;f<o[l].length;f++)o[l][f]=255&e.buffer[f+r];r+=c;var h=d.getErrorCorrectPolynomial(u),p=new n(o[l],h.getLength()-1),v=p.mod(h);s[l]=new Array(h.getLength()-1);for(var f=0;f<s[l].length;f++){var g=f+v.getLength()-s[l].length;s[l][f]=g>=0?v.get(g):0}}for(var m=0,f=0;f<t.length;f++)m+=t[f].totalCount;for(var y=new Array(m),w=0,f=0;a>f;f++)for(var l=0;l<t.length;l++)f<o[l].length&&(y[w++]=o[l][f]);for(var f=0;i>f;f++)for(var l=0;l<t.length;l++)f<s[l].length&&(y[w++]=s[l][f]);return y};for(var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},u={L:1,M:0,Q:3,H:2},f={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},d={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;d.getBCHDigit(t)-d.getBCHDigit(d.G15)>=0;)t^=d.G15<<d.getBCHDigit(t)-d.getBCHDigit(d.G15);return(e<<10|t)^d.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;d.getBCHDigit(t)-d.getBCHDigit(d.G18)>=0;)t^=d.G18<<d.getBCHDigit(t)-d.getBCHDigit(d.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return d.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case f.PATTERN000:return 0==(t+n)%2;case f.PATTERN001:return 0==t%2;case f.PATTERN010:return 0==n%3;case f.PATTERN011:return 0==(t+n)%3;case f.PATTERN100:return 0==(Math.floor(t/2)+Math.floor(n/3))%2;case f.PATTERN101:return 0==t*n%2+t*n%3;case f.PATTERN110:return 0==(t*n%2+t*n%3)%2;case f.PATTERN111:return 0==(t*n%3+(t+n)%2)%2;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new n([1],0),r=0;e>r;r++)t=t.multiply(new n([1,h.gexp(r)],0));return t},getLengthInBits:function(e,t){if(t>=1&&10>t)switch(e){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>t)switch(e){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>t))throw new Error("type:"+t);switch(e){case c.MODE_NUMBER:return 14;case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,r=0;t>r;r++)for(var a=0;t>a;a++){for(var i=0,o=e.isDark(r,a),s=-1;1>=s;s++)if(!(0>r+s||r+s>=t))for(var l=-1;1>=l;l++)0>a+l||a+l>=t||(0!=s||0!=l)&&o==e.isDark(r+s,a+l)&&i++;i>5&&(n+=3+i-5)}for(var r=0;t-1>r;r++)for(var a=0;t-1>a;a++){var c=0;e.isDark(r,a)&&c++,e.isDark(r+1,a)&&c++,e.isDark(r,a+1)&&c++,e.isDark(r+1,a+1)&&c++,(0==c||4==c)&&(n+=3)}for(var r=0;t>r;r++)for(var a=0;t-6>a;a++)e.isDark(r,a)&&!e.isDark(r,a+1)&&e.isDark(r,a+2)&&e.isDark(r,a+3)&&e.isDark(r,a+4)&&!e.isDark(r,a+5)&&e.isDark(r,a+6)&&(n+=40);for(var a=0;t>a;a++)for(var r=0;t-6>r;r++)e.isDark(r,a)&&!e.isDark(r+1,a)&&e.isDark(r+2,a)&&e.isDark(r+3,a)&&e.isDark(r+4,a)&&!e.isDark(r+5,a)&&e.isDark(r+6,a)&&(n+=40);for(var u=0,a=0;t>a;a++)for(var r=0;t>r;r++)e.isDark(r,a)&&u++;var f=Math.abs(100*u/t/t-50)/5;return n+=10*f}},h={glog:function(e){if(1>e)throw new Error("glog("+e+")");return h.LOG_TABLE[e]},gexp:function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return h.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},p=0;8>p;p++)h.EXP_TABLE[p]=1<<p;for(var p=8;256>p;p++)h.EXP_TABLE[p]=h.EXP_TABLE[p-4]^h.EXP_TABLE[p-5]^h.EXP_TABLE[p-6]^h.EXP_TABLE[p-8];for(var p=0;255>p;p++)h.LOG_TABLE[h.EXP_TABLE[p]]=p;n.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var a=0;a<e.getLength();a++)t[r+a]^=h.gexp(h.glog(this.get(r))+h.glog(e.get(a)));return new n(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=h.glog(this.get(0))-h.glog(e.get(0)),r=new Array(this.getLength()),a=0;a<this.getLength();a++)r[a]=this.get(a);for(var a=0;a<e.getLength();a++)r[a]^=h.gexp(h.glog(e.get(a))+t);return new n(r,0).mod(e)}},r.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],r.getRSBlocks=function(e,t){var n=r.getRsBlockTable(e,t);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var a=n.length/3,i=[],o=0;a>o;o++)for(var s=n[3*o+0],l=n[3*o+1],c=n[3*o+2],u=0;s>u;u++)i.push(new r(l,c));return i},r.getRsBlockTable=function(e,t){switch(t){case u.L:return r.RS_BLOCK_TABLE[4*(e-1)+0];case u.M:return r.RS_BLOCK_TABLE[4*(e-1)+1];case u.Q:return r.RS_BLOCK_TABLE[4*(e-1)+2];case u.H:return r.RS_BLOCK_TABLE[4*(e-1)+3];default:return void 0}},a.prototype={get:function(e){var t=Math.floor(e/8);return 1==(1&this.buffer[t]>>>7-e%8)},put:function(e,t){for(var n=0;t>n;n++)this.putBit(1==(1&e>>>t-n-1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var v=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],g=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function t(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var r in t)t.hasOwnProperty(r)&&n.setAttribute(r,t[r]);return n}var n=this._htOption,r=this._el,a=e.getModuleCount();Math.floor(n.width/a),Math.floor(n.height/a),this.clear();var i=t("svg",{viewBox:"0 0 "+String(a)+" "+String(a),width:"100%",height:"100%",fill:n.colorLight});i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.appendChild(i),i.appendChild(t("rect",{fill:n.colorDark,width:"1",height:"1",id:"template"}));for(var o=0;a>o;o++)for(var s=0;a>s;s++)if(e.isDark(o,s)){var l=t("use",{x:String(o),y:String(s)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),i.appendChild(l)}},e.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},e}(),m="svg"===document.documentElement.tagName.toLowerCase(),y=m?g:i()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function t(e,t){var n=this;if(n._fFail=t,n._fSuccess=e,null===n._bSupportDataURI){var r=document.createElement("img"),a=function(){n._bSupportDataURI=!1,n._fFail&&_fFail.call(n)},i=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)};return r.onabort=a,r.onerror=a,r.onload=i,void(r.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}n._bSupportDataURI===!0&&n._fSuccess?n._fSuccess.call(n):n._bSupportDataURI===!1&&n._fFail&&n._fFail.call(n)}if(this._android&&this._android<=2.1){var n=1/window.devicePixelRatio,r=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,t,a,i,o,s,l,c){if("nodeName"in e&&/img/i.test(e.nodeName))for(var u=arguments.length-1;u>=1;u--)arguments[u]=arguments[u]*n;else"undefined"==typeof c&&(arguments[1]*=n,arguments[2]*=n,arguments[3]*=n,arguments[4]*=n);r.apply(this,arguments)}}var a=function(e,t){this._bIsPainted=!1,this._android=o(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return a.prototype.draw=function(e){var t=this._elImage,n=this._oContext,r=this._htOption,a=e.getModuleCount(),i=r.width/a,o=r.height/a,s=Math.round(i),l=Math.round(o);t.style.display="none",this.clear();for(var c=0;a>c;c++)for(var u=0;a>u;u++){var f=e.isDark(c,u),d=u*i,h=c*o;n.strokeStyle=f?r.colorDark:r.colorLight,n.lineWidth=1,n.fillStyle=f?r.colorDark:r.colorLight,n.fillRect(d,h,i,o),n.strokeRect(Math.floor(d)+.5,Math.floor(h)+.5,s,l),n.strokeRect(Math.ceil(d)-.5,Math.ceil(h)-.5,s,l)}this._bIsPainted=!0},a.prototype.makeImage=function(){this._bIsPainted&&t.call(this,e)},a.prototype.isPainted=function(){return this._bIsPainted},a.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},a.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},a}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,n=this._el,r=e.getModuleCount(),a=Math.floor(t.width/r),i=Math.floor(t.height/r),o=['<table style="border:0;border-collapse:collapse;">'],s=0;r>s;s++){o.push("<tr>");for(var l=0;r>l;l++)o.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+a+"px;height:"+i+"px;background-color:"+(e.isDark(s,l)?t.colorDark:t.colorLight)+';"></td>');o.push("</tr>")}o.push("</table>"),n.innerHTML=o.join("");{var c=n.childNodes[0];(t.width-c.offsetWidth)/2,(t.height-c.offsetHeight)/2}},e.prototype.clear=function(){this._el.innerHTML=""},e}();QRCode=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:u.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._android=o(),this._el=e,this._oQRCode=null,this._oDrawing=new y(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(s(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=u}();var saveLocal=function(e,t,n){if(/android/i.test(navigator.userAgent))addCookie(e,t,1e4,"/");else{if(!window.localStorage||!window.sessionStorage)return void console.info("browser not supprt window.loalStorage!");var r=n?localStorage:sessionStorage;t?r.setItem(e,t):r.removeItem(e)}},loadLocal=function(e,t){var n=null;if(/android/i.test(navigator.userAgent))n=getCookie(e),n=chineseFromUtf8(n);else{if(!window.localStorage||!window.sessionStorage)return console.info("browser not supprt window.loalStorage!"),null;var r=t?localStorage:sessionStorage;n=r.getItem(e)}return n};Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},existsInArray=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r===t)return!0}return!1},Date.prototype.addDays=function(e){this.setDate(this.getDate()+e)};var fromStrToDate=function(e){var t=e.split(" "),n=t[0].split("-"),r=parseInt(n[0],10),a=parseInt(n[1],10)-1,i=parseInt(n[2],10);if(t.length>1){var o=t[1].split(":"),s=parseInt(o[0],10),l=parseInt(o[1],10),c=parseInt(o[2],10),u=new Date(r,a,i,s,l,c);return u}var u=new Date(r,a,i);return u},fromDateToStr=function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t},ShareManager=function(){this.uploadedFilesList=[],this.serverCachedFileHandler=null,this.onWeixinReadyHandler=null};ShareManager.prototype.setServerCachedFileHandler=function(e){this.serverCachedFileHandler=e},ShareManager.prototype.setShareInfoHandler=function(e){this.shareInfoHandler=e},ShareManager.prototype.getWxShareImgUrl=function(){var e=null;return this.shareInfoHandler&&(e=this.shareInfoHandler.getWxShareImgUrl()),e},ShareManager.prototype.getWxShareLink=function(){var e=null;return this.shareInfoHandler&&(e=this.shareInfoHandler.getWxShareLink()),e},ShareManager.prototype.getWxShareDesc=function(){var e=null;return this.shareInfoHandler&&(e=this.shareInfoHandler.getWxShareDesc()),e},ShareManager.prototype.getWxShareTitle=function(){var e=null;return this.shareInfoHandler&&(e=this.shareInfoHandler.getWxShareTitle()),e},ShareManager.prototype.shareDataToServer=function(e){this.shareInfoHandler&&this.shareInfoHandler.shareDataToServer(e)},ShareManager.prototype.shareSwitchCheck=function(e,t){this.shareInfoHandler&&this.shareInfoHandler.shareSwitchCheck(e,t)&&this.initShare()},ShareManager.prototype.initShare=function(){var e=this,t=this.getWxShareTitle(),n=this.getWxShareLink(),r=this.getWxShareImgUrl(),a=this.getWxShareDesc();this.onWeixinReadyHandler&&this.onWeixinReadyHandler(),wx.onMenuShareTimeline({title:t,link:n,imgUrl:r,success:function(){e.shareDataToServer("T")},cancel:function(){}}),wx.onMenuShareAppMessage({title:t,link:n,imgUrl:r,desc:a,success:function(){e.shareDataToServer("F")},cancel:function(){}})},ShareManager.prototype.imagePreview=function(e,t){wx.previewImage({current:e,urls:t})},ShareManager.prototype.chooseImage=function(e){wx.chooseImage({success:function(t){var n=t.localIds;e(n)},cancel:function(){e(null)}})},ShareManager.prototype.uploadImage=function(e,t){wx.uploadImage({localId:e,isShowProgressTips:1,success:function(e){var n=e.serverId;t(n)},cancel:function(){t(null)},fail:function(){t(null)}})},ShareManager.prototype.uploadImageWithUrl=function(e,t,n){this.uploadImage(e,function(r){r?ajaxPost("/upload/getImageFromWeixin",{serverIds:[r],localIds:[e],data:t},function(e){n(0==e.code?e.urls[0]:null)}):n(null)})},ShareManager.prototype.chooseAndUploadImage=function(e,t,n,r,a){var i=this;i.chooseImage(function(o){null==o?a(1):o.length>e?a(2):setTimeout(function(){n(o),async.eachSeries(o,function(e,n){var a=i.uploadedFilesList[e];a?(r(a),n()):i.uploadImageWithUrl(e,t,function(a){a?(i.uploadedFilesList[e]=a,r(a),n()):i.serverCachedFileHandler?i.serverCachedFileHandler(e,t,function(t){t?(i.uploadedFilesList[e]=t,r(t),n()):n({errorCode:3})
}):n({errorCode:3})})},function(e){a(e?e.errorCode:0)})},100)})},ShareManager.prototype.closeWindow=function(){wx.closeWindow()},ShareManager.prototype.scanQRCode=function(e){wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(t){var n=t.resultStr;e(n)}})},ShareManager.prototype.openLocation=function(e,t,n,r,a){e=parseFloat(e),t=parseFloat(t),e=Math.round(1e6*e)/1e6,t=Math.round(1e6*t)/1e6,wx.openLocation({latitude:e,longitude:t,name:n,address:r,scale:20,infoUrl:a})},ShareManager.prototype.getLocation=function(e){wx.getLocation({type:"gcj02",success:function(t){var n=t.latitude,r=t.longitude;e(n,r)},cancel:function(){e(null,null)},fail:function(){e(null,null)}})},ShareManager.prototype.getGpsLocation=function(e){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e(t.coords.latitude,t.coords.longitude)},function(){e(null,null)}):e(null,null)},ShareManager.prototype.weixinPayment=function(e,t){wx.chooseWXPay({timestamp:e.timeStamp,nonceStr:e.nonceStr,"package":e["package"],signType:e.signType,paySign:e.paySign,success:function(){t(!0)},fail:function(){t(!1)},cancel:function(){t(!1)}})};var shareManager=new ShareManager,appManager=new AppManager;$(function(){function e(){t(),n()}function t(){appManager.login(function(e){e&&(clientInfoModel.initData(),a())},!1)}function n(){window.addEventListener("load",function(){r()})}function r(){var e=null;try{e=new fz.Scroll(".ui-tab",{role:"tab"}),e.on("beforeScrollStart",function(){}),e.on("scrollEnd",function(){})}catch(t){e=null}}function a(){}e(),$(window).scroll(function(){var e=$(this).scrollTop(),t=$(document).height(),n=$(this).height();e+n==t&&clientInfoModel.onScrollRefreshScreen()})});var lastscreen="#frameMain";window.onhashchange=function(){if("#no-back"==location.hash);else{var e=location.hash;e&&""!=e||(e="#frameMain"),$(lastscreen).css("display","none"),$(e).css("display","block"),lastscreen=e,e=e.substring(6),clientInfoModel.screen=e,clientInfoModel.onScreenChange(e)}},avalon.filters.distanceFormat=function(e){if(e){var t=parseFloat(e);1>t?t=parseInt(1e3*t)+"米":10>t?t=parseFloat(t).toFixed(1)+"公里":t>=10&&(t=parseInt(t)+"公里")}else var t="";return t},avalon.filters.dateFormat=function(e){var t=new Date,n=new Date(1e3*(t/1e3-86400)),r=fromDateToStr(t,"yyyy-MM-dd"),a=fromDateToStr(n,"yyyy-MM-dd"),i=null;return i=e==r?"今天":e==a?"昨天":fromDateToStr(fromStrToDate(e),"MM月dd日")},avalon.filters.delayFormat=function(e){var t="";if(0==e)t="立即上报";else{var n=parseInt(e);n>0&&(t=n+"小时");var r=parseInt(60*(e-n));t=t+r+"分钟"}return t},avalon.filters.currencyFilter=function(e){var t=parseFloat(e);return t=t.toFixed(2)};var clientInfoModel=createModel("clientInfo",function(e){return avalon.define(e,function(e){e.domainInfo={domainId:0,domainName:"",logo:"",status:"",tel:""},e.clientDetail={rid:0,headimgurl:null,username:null,nickname:null,mobile:null,sex:null,status:null,dusername:null,politics:null,departmentId:0,department:null,role:null},e.currentAddress="",e.screen="Main",e.$scrollRefreshHandler=null,e.$initializeHandlers=[],e.$initializeStatus="N",e.currentTabPage=0,e.$initPageParameters={news:{type:1},documents:{type:1}},e.addInitializeHandler=function(t){e.$initializeHandlers.push(t)},e.setCurrentTabPage=function(t){e.currentTabPage=t},e.openScreen=function(e){window.location.href="#frame"+e},e.onScreenChange=function(){},e.setScrollRefreshHandler=function(t){e.$scrollRefreshHandler=t},e.onScrollRefreshScreen=function(){e.$scrollRefreshHandler&&e.$scrollRefreshHandler()},e.gotoAccessRightScreen=function(t,n,r,a){var i=null,o=!1;return"T"==e.clientDetail.status&&(o=!0,i=appManager.convertUrlWithWeixinAuthUserInfo("/"+t+"/"+n+".html?wechat_card_js=1&folder="+r+"&page="+a+"&domain="+e.domainInfo.domainId)),o?void(window.location.href=i):(e.traceLocationInfo(),o)},e.gotoRegisterScreen=function(t,n,r,a){var i=null,o=!1;return"R"==e.clientDetail.status?(o=!0,i=appManager.convertUrlWithWeixinAuth("/"+t+"/"+n+".html?type=S&wechat_card_js=1&folder="+r+"&page="+a+"&domain="+e.domainInfo.domainId)):"T"==e.clientDetail.status&&(o=!0,i=appManager.convertUrlWithWeixinAuthUserInfo("/"+t+"/"+n+".html?wechat_card_js=1&folder="+r+"&page="+a+"&domain="+e.domainInfo.domainId)),o?void(window.location.href=i):(e.traceLocationInfo(),o)},e.initTabEvent=function(){var e=null;try{e=new fz.Scroll(".ui-tab",{role:"tab"})}catch(t){e=null}},e.traceLocationInfo=function(){shareManager.getGpsLocation(function(t,n){t&&n&&ajaxGetBackend("/lbs/traceLocationInfo",{position:{latitude:t,longitude:n}},function(t){e.currentAddress=t.address,emergencyCreateModel&&0==emergencyCreateModel.currentEmergency.address.length&&(emergencyCreateModel.currentEmergency.address=t.address)})})},e.checkIsNewInfo=function(e){e+=" 00:00:00";var t=fromStrToDate(e),n=((new Date).getTime()-t.getTime())/1e3/60/60/24;return 3>=n?!0:!1},e.init=function(){},e.initData=function(){e.clientDetail.rid=parseInt(appManager.client.rid),e.clientDetail.headimgurl=appManager.client.headimgurl,e.clientDetail.status=appManager.client.status,e.clientDetail.username=appManager.client.username,e.clientDetail.nickname=appManager.client.nickname,e.clientDetail.sex=appManager.client.sex,e.clientDetail.mobile=appManager.client.mobile,e.clientDetail.dusername=appManager.client.dusername,e.clientDetail.politics=appManager.client.politics,e.clientDetail.departmentId=appManager.client.departmentId,e.clientDetail.department=appManager.client.department,e.clientDetail.starLevel=appManager.client.starLevel,e.clientDetail.managerLevel=appManager.client.managerLevel,e.clientDetail.role=appManager.client.role,e.domainInfo.domainId=appManager.domain.rid,e.domainInfo.domainName=appManager.domain.domainName,e.domainInfo.logo=appManager.domain.logo,e.domainInfo.status=appManager.domain.status,e.domainInfo.tel=appManager.domain.tel,e.domainInfo.address=appManager.domain.address,e.domainInfo.lat=appManager.domain.lat,e.domainInfo.lng=appManager.domain.lng,e.$initializeHandlers.length>0?async.eachSeries(e.$initializeHandlers,function(e,t){e(function(){t(null,null)})},function(){e.$initializeStatus="Y"}):e.$initializeStatus="Y"}})});